{"paragraphs":[{"text":"%angular\n<h3><b>Spark Machine Learning</b></h3>\n- <a href=\"http://spark.apache.org/docs/latest/api/python/pyspark.ml.html#pyspark.ml.regression.GBTRegressor\" target=\"_blank\">Gradient Boosting (Regression)</a>\n<br>- <a href=\"http://spark.apache.org/docs/latest/api/python/pyspark.ml.html#pyspark.ml.classification.RandomForestClassifier\" target=\"_blank\">RandomForest (Classifier)</a>\n<br>- <a href=\"http://spark.apache.org/docs/latest/api/python/pyspark.ml.html#pyspark.ml.clustering.KMeans\" target=\"_blank\">KMeans Clustering</a>\n<br>\n<br>","user":"anonymous","dateUpdated":"2017-05-02T01:02:05+0000","config":{"colWidth":12,"enabled":false,"results":{},"editorSetting":{"language":"text","editOnDblClick":true},"editorMode":"ace/mode/undefined","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"ANGULAR","data":"<h3><b>Spark Machine Learning</b></h3>\n- <a href=\"http://spark.apache.org/docs/latest/api/python/pyspark.ml.html#pyspark.ml.regression.GBTRegressor\" target=\"_blank\">Gradient Boosting (Regression)</a>\n<br>- <a href=\"http://spark.apache.org/docs/latest/api/python/pyspark.ml.html#pyspark.ml.classification.RandomForestClassifier\" target=\"_blank\">RandomForest (Classifier)</a>\n<br>- <a href=\"http://spark.apache.org/docs/latest/api/python/pyspark.ml.html#pyspark.ml.clustering.KMeans\" target=\"_blank\">KMeans Clustering</a>\n<br>\n<br>"}]},"apps":[],"jobName":"paragraph_1493685641100_-1160787820","id":"20170502-004041_1448869329","dateCreated":"2017-05-02T00:40:41+0000","dateStarted":"2017-05-02T01:01:56+0000","dateFinished":"2017-05-02T01:01:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:201"},{"title":"Import Libraries","text":"%spark2.pyspark\n\nimport datetime,time\n\nfrom pyspark.sql.types import *\nfrom pyspark.sql.functions import monotonically_increasing_id, col, expr, when, concat, lit, udf, split, unix_timestamp, round\nfrom pyspark.ml.linalg import Vectors\nfrom pyspark.ml.regression import GBTRegressor, LinearRegression, GeneralizedLinearRegression\nfrom pyspark.ml.classification import GBTClassifier, RandomForestClassifier\nfrom pyspark.ml.feature import VectorIndexer, VectorAssembler, StringIndexer\nfrom pyspark.ml.evaluation import RegressionEvaluator\nfrom pyspark.ml import Pipeline\nfrom pyspark.ml.evaluation import MulticlassClassificationEvaluator\n","user":"anonymous","dateUpdated":"2017-05-02T01:03:49+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/python","editorHide":true,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1493681262214_-178543538","id":"20170428-065524_1393921679","dateCreated":"2017-05-01T23:27:42+0000","dateStarted":"2017-05-02T01:03:49+0000","dateFinished":"2017-05-02T01:03:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:202"},{"title":"Load Data from Hive","text":"%spark2.pyspark\n\ndisney_bookings = spark.sql('select * from disney_bookings')\ndisney_resorts  = spark.sql('select * from disney_resorts')\ndisney_states   = spark.sql('select * from disney_states')\n","user":"anonymous","dateUpdated":"2017-05-02T01:03:52+0000","config":{"editorSetting":{"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1493681262215_-178928287","id":"20170428-134816_1375450451","dateCreated":"2017-05-01T23:27:42+0000","dateStarted":"2017-05-02T01:03:52+0000","dateFinished":"2017-05-02T01:03:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:203"},{"title":"Show Bookings Dataset","text":"%spark2.sql\n\nselect * from\n    (select * from disney_bookings limit 200) a\n    order by arrival_date\n","user":"anonymous","dateUpdated":"2017-05-02T01:41:13+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/sql","editorHide":true,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"multiBarChart":{},"lineChart":{"lineWithFocus":true},"scatterChart":{"yAxis":{"name":"rate","index":4,"aggr":"sum"},"size":{"name":"children","index":5,"aggr":"sum"},"xAxis":{"name":"arrival_date","index":2,"aggr":"sum"}}},"keys":[{"name":"arrival_date","index":2,"aggr":"sum"}],"groups":[],"values":[{"name":"length_of_stay","index":7,"aggr":"avg"},{"name":"children","index":5,"aggr":"avg"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"uid\tbooking_date\tarrival_date\tresort_id\trate\tchildren\tstate_id\tlength_of_stay\n10000008\t2017-03-02\t2017-03-04\t1\t192.94\t0\t32\t10\n10000124\t2017-03-01\t2017-03-07\t5\t112.08\t1\t3\t3\n10000037\t2017-03-06\t2017-03-08\t5\t102.39\t1\t3\t4\n10000065\t2017-03-06\t2017-03-09\t6\t188.66\t1\t16\t7\n10000127\t2017-03-08\t2017-03-09\t5\t104.46\t0\t8\t2\n10000066\t2017-03-02\t2017-03-09\t8\t102.11\t1\t7\t2\n10000175\t2017-03-03\t2017-03-10\t1\t186.39\t0\t20\t3\n10000126\t2017-03-07\t2017-03-10\t6\t191.51\t1\t37\t3\n10000040\t2017-03-08\t2017-03-11\t0\t122.77\t1\t1\t6\n10000060\t2017-03-01\t2017-03-11\t2\t314.48\t1\t19\t13\n10000048\t2017-03-09\t2017-03-12\t0\t116.03\t2\t8\t5\n10000088\t2017-03-08\t2017-03-13\t5\t105.98\t0\t9\t2\n10000193\t2017-03-07\t2017-03-13\t6\t191.59\t0\t10\t2\n10000024\t2017-03-02\t2017-03-13\t9\t445.3\t1\t12\t2\n10000086\t2017-03-05\t2017-03-13\t4\t205.55\t1\t26\t3\n10000087\t2017-03-09\t2017-03-15\t5\t112.57\t1\t23\t4\n10000129\t2017-03-03\t2017-03-15\t2\t313.45\t1\t19\t3\n10000051\t2017-03-13\t2017-03-15\t5\t97.88\t1\t11\t1\n10000042\t2017-03-07\t2017-03-16\t7\t207.59\t1\t31\t4\n10000061\t2017-03-07\t2017-03-16\t7\t201.54\t0\t20\t2\n10000174\t2017-03-07\t2017-03-16\t0\t117.83\t1\t42\t3\n10000173\t2017-03-08\t2017-03-17\t1\t191.04\t4\t26\t6\n10000142\t2017-03-15\t2017-03-18\t0\t119.78\t1\t16\t8\n10000188\t2017-03-07\t2017-03-18\t9\t445.19\t0\t31\t2\n10000009\t2017-03-07\t2017-03-18\t8\t99.0\t0\t8\t3\n10000079\t2017-03-07\t2017-03-18\t0\t117.36\t4\t19\t6\n10000168\t2017-03-10\t2017-03-19\t8\t95.95\t1\t20\t1\n10000001\t2017-03-13\t2017-03-20\t0\t120.11\t2\t20\t2\n10000052\t2017-03-17\t2017-03-21\t3\t331.97\t1\t8\t6\n10000130\t2017-03-14\t2017-03-21\t1\t190.62\t1\t49\t2\n10000041\t2017-03-16\t2017-03-21\t8\t108.48\t1\t47\t2\n10000182\t2017-03-18\t2017-03-21\t0\t112.75\t1\t36\t10\n10000191\t2017-03-16\t2017-03-22\t6\t189.1\t1\t15\t5\n10000063\t2017-03-03\t2017-03-22\t3\t330.27\t3\t8\t4\n10000153\t2017-03-11\t2017-03-22\t1\t187.91\t5\t34\t2\n10000096\t2017-03-22\t2017-03-23\t6\t189.63\t1\t18\t7\n10000118\t2017-03-22\t2017-03-23\t5\t106.24\t1\t40\t2\n10000094\t2017-03-13\t2017-03-23\t6\t187.02\t0\t6\t3\n10000112\t2017-03-15\t2017-03-24\t7\t209.03\t0\t26\t2\n10000189\t2017-03-20\t2017-03-24\t0\t114.72\t0\t23\t3\n10000089\t2017-03-22\t2017-03-24\t0\t119.77\t0\t24\t6\n10000039\t2017-03-22\t2017-03-24\t0\t119.38\t1\t16\t2\n10000062\t2017-03-15\t2017-03-25\t8\t105.99\t0\t48\t2\n10000080\t2017-03-17\t2017-03-25\t4\t206.12\t0\t7\t2\n10000091\t2017-03-13\t2017-03-25\t0\t118.77\t2\t18\t2\n10000132\t2017-03-19\t2017-03-25\t6\t187.12\t1\t45\t4\n10000190\t2017-03-15\t2017-03-26\t8\t102.11\t0\t29\t2\n10000158\t2017-03-03\t2017-03-26\t9\t444.03\t1\t13\t4\n10000045\t2017-03-03\t2017-03-26\t5\t110.55\t2\t32\t2\n10000092\t2017-03-15\t2017-03-26\t7\t203.38\t1\t6\t3\n10000181\t2017-03-25\t2017-03-26\t1\t191.54\t1\t39\t2\n10000013\t2017-03-02\t2017-03-27\t4\t205.29\t1\t0\t2\n10000082\t2017-03-19\t2017-03-28\t9\t454.38\t2\t31\t3\n10000137\t2017-03-27\t2017-03-28\t0\t115.41\t0\t13\t9\n10000165\t2017-03-13\t2017-03-28\t0\t119.44\t2\t43\t6\n10000032\t2017-03-03\t2017-03-28\t2\t322.88\t0\t2\t5\n10000108\t2017-03-06\t2017-03-28\t9\t452.82\t2\t2\t3\n10000034\t2017-03-17\t2017-03-30\t3\t330.1\t1\t31\t8\n10000067\t2017-03-20\t2017-03-30\t1\t191.8\t5\t26\t2\n10000149\t2017-03-28\t2017-03-30\t2\t318.88\t7\t8\t9\n10000171\t2017-03-09\t2017-03-31\t6\t190.92\t2\t3\t6\n10000028\t2017-03-22\t2017-03-31\t9\t448.91\t2\t19\t2\n10000084\t2017-03-22\t2017-03-31\t3\t331.26\t1\t7\t6\n10000170\t2017-03-07\t2017-03-31\t7\t207.04\t1\t44\t3\n10000146\t2017-03-16\t2017-03-31\t3\t329.59\t3\t14\t7\n10000152\t2017-03-27\t2017-03-31\t0\t114.85\t1\t15\t9\n10000073\t2017-03-22\t2017-03-31\t7\t207.1\t1\t26\t2\n10000046\t2017-03-24\t2017-04-01\t7\t203.43\t1\t31\t3\n10000154\t2017-03-26\t2017-04-01\t8\t98.58\t0\t23\t2\n10000068\t2017-03-25\t2017-04-01\t0\t119.13\t1\t9\t3\n10000107\t2017-03-23\t2017-04-01\t5\t109.75\t1\t12\t2\n10000155\t2017-03-30\t2017-04-02\t6\t191.77\t1\t9\t4\n10000030\t2017-03-28\t2017-04-02\t8\t111.81\t0\t31\t1\n10000074\t2017-03-23\t2017-04-02\t3\t332.84\t2\t31\t5\n10000090\t2017-03-11\t2017-04-03\t7\t204.64\t0\t21\t3\n10000169\t2017-03-01\t2017-04-03\t9\t452.19\t1\t48\t2\n10000144\t2017-03-07\t2017-04-03\t2\t316.12\t2\t36\t11\n10000014\t2017-03-11\t2017-04-03\t2\t318.26\t1\t35\t6\n10000167\t2017-03-31\t2017-04-04\t5\t105.73\t0\t18\t4\n10000147\t2017-03-27\t2017-04-04\t3\t329.47\t0\t12\t3\n10000017\t2017-03-26\t2017-04-04\t9\t458.33\t1\t26\t3\n10000102\t2017-03-21\t2017-04-04\t0\t112.2\t1\t34\t8\n10000093\t2017-03-03\t2017-04-05\t7\t206.82\t1\t2\t1\n10000162\t2017-03-08\t2017-04-06\t4\t208.9\t1\t3\t2\n10000035\t2017-03-03\t2017-04-06\t3\t328.61\t1\t13\t9\n10000054\t2017-03-08\t2017-04-07\t2\t319.3\t4\t35\t4\n10000183\t2017-03-29\t2017-04-07\t5\t102.74\t1\t31\t4\n10000105\t2017-03-02\t2017-04-08\t3\t330.39\t3\t39\t3\n10000049\t2017-03-11\t2017-04-09\t3\t330.53\t0\t18\t10\n10000036\t2017-03-31\t2017-04-09\t5\t102.95\t0\t37\t3\n10000104\t2017-03-03\t2017-04-09\t7\t204.74\t1\t17\t3\n10000148\t2017-03-19\t2017-04-09\t9\t450.93\t0\t40\t2\n10000055\t2017-03-14\t2017-04-11\t9\t441.13\t0\t28\t3\n10000176\t2017-03-20\t2017-04-11\t9\t448.98\t0\t45\t3\n10000185\t2017-03-21\t2017-04-12\t7\t207.19\t1\t41\t3\n10000016\t2017-03-30\t2017-04-12\t2\t321.5\t3\t29\t3\n10000043\t2017-03-20\t2017-04-13\t7\t207.0\t1\t46\t3\n10000072\t2017-03-06\t2017-04-13\t7\t207.03\t2\t35\t4\n10000097\t2017-03-30\t2017-04-13\t0\t117.46\t1\t2\t10\n10000012\t2017-03-30\t2017-04-13\t8\t107.42\t2\t41\t1\n10000018\t2017-03-20\t2017-04-13\t4\t207.86\t0\t14\t2\n10000026\t2017-03-18\t2017-04-14\t2\t318.96\t3\t1\t7\n10000133\t2017-03-15\t2017-04-14\t4\t204.75\t1\t41\t2\n10000050\t2017-03-12\t2017-04-15\t4\t205.69\t0\t24\t3\n10000059\t2017-03-14\t2017-04-16\t9\t447.94\t1\t47\t4\n10000116\t2017-03-20\t2017-04-16\t2\t322.72\t5\t33\t8\n10000011\t2017-03-03\t2017-04-17\t6\t193.9\t1\t43\t4\n10000103\t2017-03-13\t2017-04-17\t9\t445.87\t1\t40\t5\n10000177\t2017-03-13\t2017-04-18\t4\t205.98\t1\t21\t3\n10000180\t2017-03-21\t2017-04-18\t9\t456.51\t1\t33\t2\n10000098\t2017-03-09\t2017-04-19\t7\t207.13\t1\t22\t1\n10000075\t2017-03-20\t2017-04-19\t9\t453.34\t1\t47\t4\n10000022\t2017-03-06\t2017-04-19\t2\t319.62\t1\t45\t9\n10000025\t2017-03-19\t2017-04-20\t6\t191.74\t3\t46\t7\n10000070\t2017-03-20\t2017-04-20\t7\t202.67\t2\t1\t2\n10000143\t2017-03-03\t2017-04-20\t9\t451.14\t0\t47\t1\n10000077\t2017-03-09\t2017-04-20\t7\t204.75\t1\t11\t2\n10000166\t2017-03-17\t2017-04-20\t5\t104.46\t3\t5\t5\n10000015\t2017-03-22\t2017-04-20\t3\t330.33\t1\t37\t2\n10000002\t2017-03-11\t2017-04-20\t7\t207.08\t1\t47\t3\n10000192\t2017-03-27\t2017-04-20\t0\t117.84\t1\t8\t2\n10000010\t2017-03-15\t2017-04-20\t3\t331.12\t1\t28\t4\n10000109\t2017-03-22\t2017-04-21\t5\t108.39\t1\t14\t3\n10000134\t2017-03-30\t2017-04-21\t2\t320.2\t3\t48\t12\n10000156\t2017-03-21\t2017-04-21\t5\t99.15\t2\t10\t3\n10000159\t2017-03-12\t2017-04-22\t7\t206.51\t1\t23\t2\n10000199\t2017-03-24\t2017-04-22\t7\t206.22\t1\t25\t2\n10000000\t2017-03-24\t2017-04-22\t3\t331.1\t2\t41\t2\n10000198\t2017-03-15\t2017-04-23\t3\t329.86\t0\t22\t2\n10000184\t2017-03-12\t2017-04-24\t4\t203.42\t1\t18\t2\n10000195\t2017-03-03\t2017-04-24\t2\t316.37\t7\t27\t4\n10000057\t2017-03-12\t2017-04-24\t6\t194.12\t6\t10\t7\n10000106\t2017-03-25\t2017-04-24\t3\t331.66\t2\t44\t7\n10000172\t2017-03-16\t2017-04-25\t7\t207.03\t1\t44\t2\n10000101\t2017-03-31\t2017-04-25\t4\t206.87\t1\t22\t2\n10000071\t2017-03-19\t2017-04-25\t4\t206.12\t0\t33\t3\n10000076\t2017-03-29\t2017-04-25\t4\t207.3\t1\t3\t2\n10000125\t2017-03-30\t2017-04-26\t4\t209.51\t0\t38\t2\n10000163\t2017-03-08\t2017-04-26\t7\t207.81\t2\t0\t3\n10000179\t2017-03-21\t2017-04-26\t2\t323.77\t5\t1\t5\n10000100\t2017-03-31\t2017-04-26\t4\t202.47\t1\t39\t3\n10000114\t2017-03-23\t2017-04-26\t9\t456.61\t1\t48\t3\n10000044\t2017-03-02\t2017-04-27\t2\t319.28\t2\t47\t11\n10000003\t2017-03-15\t2017-04-27\t2\t317.24\t3\t46\t6\n10000021\t2017-03-26\t2017-04-27\t4\t207.21\t0\t16\t2\n10000115\t2017-03-30\t2017-04-28\t7\t201.8\t2\t13\t2\n10000161\t2017-03-04\t2017-04-28\t1\t191.09\t2\t27\t4\n10000099\t2017-03-29\t2017-04-29\t2\t318.79\t1\t13\t6\n10000083\t2017-03-12\t2017-04-30\t7\t203.08\t1\t18\t3\n10000119\t2017-03-15\t2017-04-30\t7\t205.41\t0\t9\t2\n10000019\t2017-03-27\t2017-04-30\t1\t189.32\t4\t27\t2\n10000005\t2017-03-29\t2017-05-01\t6\t186.55\t3\t5\t9\n10000053\t2017-03-15\t2017-05-01\t2\t317.96\t3\t41\t6\n10000194\t2017-03-18\t2017-05-01\t3\t331.64\t1\t37\t3\n10000033\t2017-03-29\t2017-05-02\t9\t453.43\t2\t9\t3\n10000095\t2017-03-19\t2017-05-03\t4\t204.6\t1\t13\t3\n10000111\t2017-03-23\t2017-05-03\t8\t104.67\t0\t4\t2\n10000004\t2017-03-18\t2017-05-03\t9\t456.49\t2\t16\t7\n10000196\t2017-03-27\t2017-05-04\t7\t204.53\t0\t21\t4\n10000029\t2017-03-05\t2017-05-04\t0\t111.01\t2\t37\t2\n10000160\t2017-03-22\t2017-05-05\t8\t97.98\t0\t14\t1\n10000164\t2017-03-25\t2017-05-05\t7\t207.13\t1\t48\t2\n10000197\t2017-03-07\t2017-05-05\t9\t447.97\t1\t41\t4\n10000141\t2017-03-19\t2017-05-05\t3\t327.38\t1\t2\t2\n10000157\t2017-03-11\t2017-05-06\t2\t315.0\t1\t0\t15\n10000186\t2017-03-11\t2017-05-06\t6\t185.46\t2\t2\t3\n10000110\t2017-03-31\t2017-05-06\t7\t201.26\t0\t11\t2\n10000131\t2017-03-27\t2017-05-07\t3\t328.79\t3\t4\t8\n10000178\t2017-03-21\t2017-05-07\t6\t190.48\t4\t28\t3\n10000007\t2017-03-14\t2017-05-09\t3\t326.78\t4\t15\t2\n10000047\t2017-03-24\t2017-05-09\t4\t201.91\t1\t21\t2\n10000123\t2017-03-23\t2017-05-09\t2\t314.25\t5\t35\t4\n10000023\t2017-03-13\t2017-05-11\t0\t118.58\t1\t46\t10\n10000151\t2017-03-09\t2017-05-12\t2\t324.44\t3\t5\t4\n10000085\t2017-03-31\t2017-05-12\t2\t319.46\t5\t45\t7\n10000064\t2017-03-28\t2017-05-12\t7\t204.24\t0\t46\t3\n10000056\t2017-03-01\t2017-05-13\t0\t115.9\t2\t22\t2\n10000058\t2017-03-24\t2017-05-14\t4\t203.12\t0\t48\t2\n10000145\t2017-03-28\t2017-05-14\t1\t186.88\t4\t0\t9\n10000020\t2017-03-30\t2017-05-14\t3\t330.71\t1\t30\t2\n10000081\t2017-03-29\t2017-05-15\t2\t323.84\t4\t35\t2\n10000135\t2017-03-28\t2017-05-17\t2\t322.97\t4\t48\t3\n10000150\t2017-03-23\t2017-05-28\t9\t450.39\t2\t46\t2\n10000128\t2017-03-21\t2017-05-31\t0\t115.43\t3\t47\t3\n10000139\t2017-03-03\t2017-05-31\t6\t189.36\t3\t42\t4\n10000122\t2017-03-31\t2017-06-09\t0\t120.12\t3\t15\t7\n10000027\t2017-03-17\t2017-06-11\t8\t104.16\t2\t48\t2\n10000117\t2017-03-19\t2017-06-14\t0\t120.97\t2\t1\t6\n10000121\t2017-03-05\t2017-06-14\t1\t196.19\t4\t48\t7\n10000187\t2017-03-30\t2017-06-24\t1\t192.47\t3\t9\t9\n10000006\t2017-03-24\t2017-06-25\t5\t98.54\t2\t32\t5\n10000138\t2017-03-21\t2017-06-26\t1\t191.4\t4\t18\t10\n10000038\t2017-03-28\t2017-07-11\t5\t109.14\t4\t11\t4\n10000136\t2017-03-21\t2017-07-14\t1\t194.2\t2\t25\t5\n10000140\t2017-03-31\t2017-07-19\t6\t194.02\t2\t25\t3\n10000113\t2017-03-23\t2017-07-19\t6\t188.69\t5\t17\t9\n10000078\t2017-03-22\t2017-07-20\t6\t191.01\t3\t45\t4\n10000120\t2017-03-18\t2017-07-21\t1\t191.97\t2\t40\t2\n10000069\t2017-03-16\t2017-07-26\t0\t118.48\t2\t13\t10\n10000031\t2017-03-25\t2017-08-04\t6\t192.34\t4\t13\t2\n"}]},"apps":[],"jobName":"paragraph_1493681262215_-178928287","id":"20170428-134917_169798028","dateCreated":"2017-05-01T23:27:42+0000","dateStarted":"2017-05-02T01:03:55+0000","dateFinished":"2017-05-02T01:03:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:204"},{"title":"Output Descriptive Stats","text":"%spark2.pyspark\n\nprint \"\\n\\r\\n\\rTotal Bookings: \" + str(disney_bookings.count()) + '\\r\\n\\r\\n'\n\ndisney_bookings.describe(['rate','children','length_of_stay']).show(10,False)\n","dateUpdated":"2017-05-02T01:47:46+0000","config":{"editorSetting":{"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","editorHide":true,"title":true,"results":{"0":{"graph":{"mode":"table","height":452,"optionOpen":false}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\n\r\n\rTotal Bookings: 1000000\r\n\r\n\n+-------+------------------+------------------+------------------+\n|summary|rate              |children          |length_of_stay    |\n+-------+------------------+------------------+------------------+\n|count  |1000000           |1000000           |1000000           |\n|mean   |221.52218654691313|1.563063          |4.082302          |\n|stddev |107.11170851671967|1.3735373837781062|2.4771012326561106|\n|min    |95.02             |0                 |1                 |\n|max    |459.96            |8                 |16                |\n+-------+------------------+------------------+------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1493681262215_-180852032","id":"20170428-134837_1084160576","dateCreated":"2017-05-01T23:27:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:205","user":"anonymous","dateFinished":"2017-05-02T01:47:44+0000","dateStarted":"2017-05-02T01:47:44+0000"},{"text":"%spark2.sql\n\nSELECT resort, \n        avg(days_until_arrival) as avg_days_until_arrival,\n        avg(rate) as avg_rate,\n        avg(length_of_stay) as avg_length_of_stay,\n        avg(children) as avg_children\n    FROM \n    \n    (SELECT disney_bookings.*, disney_resorts.resort, disney_states.state,\n        datediff(to_date(disney_bookings.arrival_date), to_date(disney_bookings.booking_date)) as days_until_arrival\n        FROM disney_bookings \n            JOIN disney_resorts ON (disney_bookings.resort_id = disney_resorts.resort_id) \n            JOIN disney_states ON (disney_states.state_id = disney_bookings.state_id)) a\n    \n    GROUP BY resort\n    ORDER BY avg_days_until_arrival desc","user":"anonymous","dateUpdated":"2017-05-02T01:54:08+0000","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{"stacked":false}},"commonSetting":{},"keys":[{"name":"resort","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"avg_days_until_arrival","index":1,"aggr":"avg"},{"name":"avg_length_of_stay","index":3,"aggr":"avg"},{"name":"avg_children","index":4,"aggr":"avg"}]},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql","editorHide":true,"title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1493689176837_518095439","id":"20170502-013936_535061464","dateCreated":"2017-05-02T01:39:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2212","dateFinished":"2017-05-02T01:54:11+0000","dateStarted":"2017-05-02T01:54:08+0000","title":"Aggregations by Property / Resort","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"resort\tavg_days_until_arrival\tavg_rate\tavg_length_of_stay\tavg_children\nCaribbean Beach Resort \t38.443186691533604\t192.00546360005407\t4.50214926147187\t2.401218745948318\nCoronoda Spring Resort \t37.04725415070243\t190.34555894813928\t4.822767001915709\t2.165090197956577\nAll-Star Music Resort \t33.22790939651033\t103.33032806293285\t3.500760364975188\t1.768979109972787\nPop Century Resort \t32.92498292555542\t117.33369068507282\t5.833845566670684\t1.7289883893776867\nPort Orleans Resort Riverside \t30.26334704828263\t205.3330975909921\t2.3343844790821997\t0.6779289425473767\nSaratoga Springs Resort and Spa \t30.22236685324068\t329.9992260386382\t4.845931251314195\t1.3987844319171732\nPort Orleans Resort French Quarter\t30.217148544414034\t205.32779588291675\t2.829649166459318\t1.022403582980841\nPolynesian Village Resort\t30.20359694949859\t450.6785002929697\t3.5028022978842652\t0.9867391260833884\nAnimal Kingdom Lodge \t30.146129391353185\t317.98756549828283\t6.839820284215699\t2.8070361938764252\nAll-Star Sports Resort\t13.527570536828964\t103.3300069002492\t1.8307715355805243\t0.6762946317103621\n"}]}},{"title":"Transformations & Model Prep","text":"%spark2.pyspark\n\n# Calculate Booking lead time (arrival date - booking date)\ndateDiff = round((unix_timestamp('arrival_date', format='yyyy-MM-dd') - unix_timestamp('booking_date', format='yyyy-MM-dd')) / (60*60*24))\n#dateDiff = round((unix_timestamp('arrival_date', format='MM/dd/yy') - unix_timestamp('booking_date', format='MM/dd/yy')) / (60*60*24))\ntransformed1 = disney_bookings.withColumn(\"days_until_arrival\", dateDiff)\n\n\n# Calculate Day of Week\ndef get_dow(date):\n    # Where Monday is 0 and Sunday is 6\n    weekday = datetime.datetime.strptime(date, '%Y-%m-%d').weekday()\n    return weekday\n\ndef bucket_value(value):\n    if 0 <= value <= 7:\n        bucket = 1\n    elif 7 < value <= 30:\n        bucket = 2\n    elif 30 < value <= 60:\n        bucket = 3\n    else:\n        bucket = 4\n    \n    return bucket\n\nf_get_dow       = udf(get_dow,      IntegerType())\nf_bucket_value  = udf(bucket_value, IntegerType())\n\ntransformed1 = transformed1.withColumn(\"dow\", f_get_dow(transformed1.booking_date) ) \\\n                           .withColumn(\"days_until_arrival_cat\", f_bucket_value(transformed1.days_until_arrival) )\n                            #.withColumn(\"booding_month\", split(transformed1.booking_date,\"-\")[1].cast(\"integer\") ) \\\n                            #.withColumn(\"booking_day\",   split(transformed1.booking_date,\"-\")[2].cast(\"integer\") )\n\n\n# Select variables for model and cast data types\ntransformed1 = transformed1.select( \\\n                    transformed1.resort_id.cast(\"int\"), \\\n                    transformed1.rate.cast(\"float\"), \\\n                    transformed1.children.cast(\"int\"), \\\n                    transformed1.state_id.cast(\"int\"), \\\n                    transformed1.length_of_stay.cast(\"int\"), \\\n                    transformed1.dow.cast(\"int\"), \\\n                    transformed1.days_until_arrival.cast(\"float\"), \\\n                    transformed1.days_until_arrival_cat.cast(\"int\") \\\n                    )\n\n\n# Show variable Data Types for each column\nfor var in transformed1.dtypes:\n    print var\n\n\ntransformed1.show(10,False)","dateUpdated":"2017-05-02T01:56:32+0000","config":{"editorSetting":{"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","editorHide":true,"title":true,"results":{"0":{"graph":{"mode":"table","height":400.4,"optionOpen":false}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"('resort_id', 'int')\n('rate', 'float')\n('children', 'int')\n('state_id', 'int')\n('length_of_stay', 'int')\n('dow', 'int')\n('days_until_arrival', 'float')\n('days_until_arrival_cat', 'int')\n+---------+------+--------+--------+--------------+---+------------------+----------------------+\n|resort_id|rate  |children|state_id|length_of_stay|dow|days_until_arrival|days_until_arrival_cat|\n+---------+------+--------+--------+--------------+---+------------------+----------------------+\n|3        |331.1 |2       |41      |2             |4  |29.0              |2                     |\n|0        |120.11|2       |20      |2             |0  |7.0               |1                     |\n|7        |207.08|1       |47      |3             |5  |40.0              |3                     |\n|2        |317.24|3       |46      |6             |2  |43.0              |3                     |\n|9        |456.49|2       |16      |7             |5  |46.0              |3                     |\n|6        |186.55|3       |5       |9             |2  |33.0              |3                     |\n|5        |98.54 |2       |32      |5             |4  |93.0              |4                     |\n|3        |326.78|4       |15      |2             |1  |56.0              |3                     |\n|1        |192.94|0       |32      |10            |3  |2.0               |1                     |\n|8        |99.0  |0       |8       |3             |1  |11.0              |2                     |\n+---------+------+--------+--------+--------------+---+------------------+----------------------+\nonly showing top 10 rows\n\n"}]},"apps":[],"jobName":"paragraph_1493681262216_-180852032","id":"20170428-135055_1790434990","dateCreated":"2017-05-01T23:27:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:206","user":"anonymous","dateFinished":"2017-05-02T01:56:46+0000","dateStarted":"2017-05-02T01:56:32+0000"},{"title":"Basic Stats - Correlation / Covariance","text":"%spark2.pyspark\n\n# Covariance\ntransformed1.stat.corr('days_until_arrival', 'days_until_arrival')\ntransformed1.stat.corr('length_of_stay','days_until_arrival')\ntransformed1.stat.corr('children', 'days_until_arrival')\n\n# Correlation\ntransformed1.stat.cov('days_until_arrival', 'days_until_arrival')\ntransformed1.stat.cov('length_of_stay', 'days_until_arrival')","dateUpdated":"2017-05-02T01:56:57+0000","config":{"editorSetting":{"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","editorHide":true,"title":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1493681262216_-180852032","id":"20170428-135352_419209214","dateCreated":"2017-05-01T23:27:42+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:207"},{"title":"Model Labels and Features - Split into TRAINING and TESTING datasets","text":"%spark2.pyspark\n\nfeatures = ['resort_id','rate','children','state_id','length_of_stay','dow']\n\n# Generate Features Vector and Label\nva = VectorAssembler(inputCols=features, outputCol=\"features\")\nmodelprep1 = va.transform(transformed1).withColumn(\"label\", col(\"days_until_arrival\"))\n\n# Random Spliting\ntraining, testing = modelprep1.randomSplit([0.8, 0.2])\n","dateUpdated":"2017-05-02T02:18:44+0000","config":{"editorSetting":{"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1493681262218_-180082534","id":"20170428-135752_1623432211","dateCreated":"2017-05-01T23:27:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:208","user":"anonymous","dateFinished":"2017-05-02T02:18:44+0000","dateStarted":"2017-05-02T02:18:44+0000"},{"title":"Modeling - Gradient Boosting (Regression)","text":"%spark2.pyspark\n\ngbt = GBTRegressor(featuresCol=\"features\", labelCol=\"label\", predictionCol=\"prediction\", maxDepth=5, maxBins=32, maxIter=20, seed=12345)\n#gbt = GBTClassifier(featuresCol=\"features\", labelCol=\"label\", predictionCol=\"prediction\", maxDepth=5, maxBins=32, maxIter=20, seed=12345)\n\ngbtmodel = gbt.fit(training)\n\n# Make predictions.\npredictions = gbtmodel.transform(testing)\n\n# Select example rows to display.\npredictions.select(\"prediction\", \"label\").show(30,False)\n\nevaluator = RegressionEvaluator(metricName=\"rmse\")  # rmse (default)|mse|r2|mae\nRMSE = evaluator.evaluate(predictions)\nprint 'RMSE: ' + str(RMSE)\n\npredictions.createOrReplaceTempView('predictions_sql')\n","dateUpdated":"2017-05-02T02:18:49+0000","config":{"editorSetting":{"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------------+-----+\n|prediction        |label|\n+------------------+-----+\n|50.68334241748679 |59.0 |\n|16.894013153089936|12.0 |\n|6.4583271016258195|12.0 |\n|5.350837770744928 |4.0  |\n|7.706881936888375 |2.0  |\n|8.028380817338704 |1.0  |\n|67.5680033014719  |62.0 |\n|5.649836191657455 |4.0  |\n|5.353254811111062 |4.0  |\n|6.847422109150117 |11.0 |\n|5.350837770744928 |7.0  |\n|7.706881936888375 |1.0  |\n|52.71728142938643 |104.0|\n|40.49663118249314 |45.0 |\n|70.57400789956256 |96.0 |\n|16.894013153089936|14.0 |\n|58.064339452367065|34.0 |\n|5.651791861760737 |7.0  |\n|6.847422109150117 |10.0 |\n|3.5641960274198277|14.0 |\n|7.547680408543344 |11.0 |\n|59.7929101342601  |23.0 |\n|11.014882411815488|8.0  |\n|40.49663118249314 |23.0 |\n|67.5680033014719  |51.0 |\n|58.25545668509204 |22.0 |\n|70.69016939851163 |110.0|\n|59.7929101342601  |147.0|\n|59.21845739561287 |61.0 |\n|7.635717841057315 |6.0  |\n+------------------+-----+\nonly showing top 30 rows\n\nRMSE: 18.8207298157\n"}]},"apps":[],"jobName":"paragraph_1493681262218_-180082534","id":"20170428-135853_1273921160","dateCreated":"2017-05-01T23:27:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:209","user":"anonymous","dateFinished":"2017-05-02T02:21:41+0000","dateStarted":"2017-05-02T02:18:49+0000"},{"title":"Display Predictions (Y) versus Labels (X)","text":"%spark2.sql\n\nselect * from predictions_sql limit 200","dateUpdated":"2017-05-02T02:26:54+0000","config":{"editorSetting":{"language":"sql"},"colWidth":12,"editorMode":"ace/mode/sql","editorHide":true,"title":true,"results":{"0":{"graph":{"mode":"scatterChart","height":300,"optionOpen":false,"setting":{"scatterChart":{"xAxis":{"name":"label","index":9,"aggr":"sum"},"yAxis":{"name":"prediction","index":10,"aggr":"sum"},"size":{"name":"children","index":2,"aggr":"sum"}}}},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"resort_id\trate\tchildren\tstate_id\tlength_of_stay\tdow\tdays_until_arrival\tdays_until_arrival_cat\tfeatures\tlabel\tprediction\n0\t110.07\t2\t14\t8\t2\t59.0\t3\t[0.0,110.06999969482422,2.0,14.0,8.0,2.0]\t59.0\t50.68334241748679\n0\t110.11\t2\t19\t6\t4\t12.0\t2\t[0.0,110.11000061035156,2.0,19.0,6.0,4.0]\t12.0\t16.894013153089936\n0\t110.16\t0\t7\t6\t5\t12.0\t2\t[0.0,110.16000366210938,0.0,7.0,6.0,5.0]\t12.0\t6.4583271016258195\n0\t110.16\t1\t49\t5\t1\t4.0\t1\t[0.0,110.16000366210938,1.0,49.0,5.0,1.0]\t4.0\t5.350837770744928\n0\t110.17\t0\t13\t10\t1\t2.0\t1\t[0.0,110.16999816894531,0.0,13.0,10.0,1.0]\t2.0\t7.706881936888375\n0\t110.17\t1\t10\t3\t1\t1.0\t1\t[0.0,110.16999816894531,1.0,10.0,3.0,1.0]\t1.0\t8.028380817338704\n0\t110.17\t2\t23\t3\t1\t62.0\t4\t[0.0,110.16999816894531,2.0,23.0,3.0,1.0]\t62.0\t67.5680033014719\n0\t110.18\t0\t25\t8\t0\t4.0\t1\t[0.0,110.18000030517578,0.0,25.0,8.0,0.0]\t4.0\t5.649836191657455\n0\t110.2\t1\t38\t6\t1\t4.0\t1\t[0.0,110.19999694824219,1.0,38.0,6.0,1.0]\t4.0\t5.353254811111062\n0\t110.22\t0\t31\t7\t4\t11.0\t2\t[0.0,110.22000122070312,0.0,31.0,7.0,4.0]\t11.0\t6.847422109150117\n0\t110.22\t1\t49\t2\t1\t7.0\t1\t[0.0,110.22000122070312,1.0,49.0,2.0,1.0]\t7.0\t5.350837770744928\n0\t110.23\t0\t13\t4\t1\t1.0\t1\t[0.0,110.2300033569336,0.0,13.0,4.0,1.0]\t1.0\t7.706881936888375\n0\t110.23\t2\t13\t5\t1\t104.0\t4\t[0.0,110.2300033569336,2.0,13.0,5.0,1.0]\t104.0\t52.71728142938643\n0\t110.23\t3\t4\t7\t6\t45.0\t3\t[0.0,110.2300033569336,3.0,4.0,7.0,6.0]\t45.0\t40.49663118249314\n0\t110.24\t3\t0\t8\t4\t96.0\t4\t[0.0,110.23999786376953,3.0,0.0,8.0,4.0]\t96.0\t70.57400789956256\n0\t110.24\t4\t19\t11\t2\t14.0\t2\t[0.0,110.23999786376953,4.0,19.0,11.0,2.0]\t14.0\t16.894013153089936\n0\t110.24\t4\t32\t8\t5\t34.0\t3\t[0.0,110.23999786376953,4.0,32.0,8.0,5.0]\t34.0\t58.064339452367065\n0\t110.25\t0\t1\t7\t5\t7.0\t1\t[0.0,110.25,0.0,1.0,7.0,5.0]\t7.0\t5.651791861760737\n0\t110.25\t1\t31\t6\t3\t10.0\t2\t[0.0,110.25,1.0,31.0,6.0,3.0]\t10.0\t6.847422109150117\n0\t110.27\t1\t34\t9\t2\t14.0\t2\t[0.0,110.2699966430664,1.0,34.0,9.0,2.0]\t14.0\t3.5641960274198277\n0\t110.28\t0\t21\t3\t2\t11.0\t2\t[0.0,110.27999877929688,0.0,21.0,3.0,2.0]\t11.0\t7.547680408543344\n0\t110.28\t3\t28\t7\t1\t23.0\t2\t[0.0,110.27999877929688,3.0,28.0,7.0,1.0]\t23.0\t59.7929101342601\n0\t110.29\t0\t26\t5\t1\t8.0\t2\t[0.0,110.29000091552734,0.0,26.0,5.0,1.0]\t8.0\t11.014882411815488\n0\t110.29\t2\t3\t3\t1\t23.0\t2\t[0.0,110.29000091552734,2.0,3.0,3.0,1.0]\t23.0\t40.49663118249314\n0\t110.29\t2\t22\t7\t5\t51.0\t3\t[0.0,110.29000091552734,2.0,22.0,7.0,5.0]\t51.0\t67.5680033014719\n0\t110.29\t2\t44\t3\t2\t22.0\t2\t[0.0,110.29000091552734,2.0,44.0,3.0,2.0]\t22.0\t58.25545668509204\n0\t110.29\t3\t36\t6\t6\t110.0\t4\t[0.0,110.29000091552734,3.0,36.0,6.0,6.0]\t110.0\t70.69016939851163\n0\t110.3\t2\t28\t5\t3\t147.0\t4\t[0.0,110.30000305175781,2.0,28.0,5.0,3.0]\t147.0\t59.7929101342601\n0\t110.3\t3\t28\t2\t5\t61.0\t4\t[0.0,110.30000305175781,3.0,28.0,2.0,5.0]\t61.0\t59.21845739561287\n0\t110.32\t1\t8\t2\t1\t6.0\t1\t[0.0,110.31999969482422,1.0,8.0,2.0,1.0]\t6.0\t7.635717841057315\n0\t110.32\t1\t41\t4\t4\t3.0\t1\t[0.0,110.31999969482422,1.0,41.0,4.0,4.0]\t3.0\t5.353254811111062\n0\t110.33\t0\t21\t3\t1\t5.0\t1\t[0.0,110.33000183105469,0.0,21.0,3.0,1.0]\t5.0\t7.547680408543344\n0\t110.34\t1\t41\t9\t0\t2.0\t1\t[0.0,110.33999633789062,1.0,41.0,9.0,0.0]\t2.0\t5.353254811111062\n0\t110.34\t2\t48\t5\t4\t32.0\t3\t[0.0,110.33999633789062,2.0,48.0,5.0,4.0]\t32.0\t69.66570208387161\n0\t110.35\t1\t13\t3\t1\t2.0\t1\t[0.0,110.3499984741211,1.0,13.0,3.0,1.0]\t2.0\t7.706881936888375\n0\t110.35\t1\t28\t4\t1\t2.0\t1\t[0.0,110.3499984741211,1.0,28.0,4.0,1.0]\t2.0\t6.96397079045418\n0\t110.36\t2\t4\t1\t1\t26.0\t2\t[0.0,110.36000061035156,2.0,4.0,1.0,1.0]\t26.0\t40.49663118249314\n0\t110.36\t2\t22\t11\t6\t30.0\t2\t[0.0,110.36000061035156,2.0,22.0,11.0,6.0]\t30.0\t67.5680033014719\n0\t110.36\t2\t28\t2\t1\t66.0\t4\t[0.0,110.36000061035156,2.0,28.0,2.0,1.0]\t66.0\t59.21845739561287\n0\t110.38\t1\t21\t8\t2\t8.0\t2\t[0.0,110.37999725341797,1.0,21.0,8.0,2.0]\t8.0\t7.547680408543344\n0\t110.38\t2\t4\t3\t1\t26.0\t2\t[0.0,110.37999725341797,2.0,4.0,3.0,1.0]\t26.0\t40.49663118249314\n0\t110.38\t3\t47\t5\t6\t54.0\t3\t[0.0,110.37999725341797,3.0,47.0,5.0,6.0]\t54.0\t69.66570208387161\n0\t110.38\t5\t42\t3\t5\t53.0\t3\t[0.0,110.37999725341797,5.0,42.0,3.0,5.0]\t53.0\t57.999949119897266\n0\t110.4\t1\t18\t4\t2\t11.0\t2\t[0.0,110.4000015258789,1.0,18.0,4.0,2.0]\t11.0\t4.479227052264021\n0\t110.41\t2\t33\t7\t6\t148.0\t4\t[0.0,110.41000366210938,2.0,33.0,7.0,6.0]\t148.0\t65.32177063371695\n0\t110.41\t2\t35\t5\t5\t7.0\t1\t[0.0,110.41000366210938,2.0,35.0,5.0,5.0]\t7.0\t59.32814284747064\n0\t110.42\t1\t22\t6\t1\t5.0\t1\t[0.0,110.41999816894531,1.0,22.0,6.0,1.0]\t5.0\t8.218474047248439\n0\t110.43\t2\t49\t8\t3\t17.0\t2\t[0.0,110.43000030517578,2.0,49.0,8.0,3.0]\t17.0\t69.66570208387161\n0\t110.43\t3\t6\t2\t2\t8.0\t2\t[0.0,110.43000030517578,3.0,6.0,2.0,2.0]\t8.0\t20.635731058573427\n0\t110.44\t0\t14\t1\t3\t27.0\t2\t[0.0,110.44000244140625,0.0,14.0,1.0,3.0]\t27.0\t25.617054762749177\n0\t110.44\t3\t41\t12\t2\t128.0\t4\t[0.0,110.44000244140625,3.0,41.0,12.0,2.0]\t128.0\t70.69016939851163\n0\t110.46\t0\t38\t6\t4\t3.0\t1\t[0.0,110.45999908447266,0.0,38.0,6.0,4.0]\t3.0\t5.353254811111062\n0\t110.46\t1\t30\t3\t0\t3.0\t1\t[0.0,110.45999908447266,1.0,30.0,3.0,0.0]\t3.0\t6.6675243430901086\n0\t110.47\t1\t18\t6\t0\t1.0\t1\t[0.0,110.47000122070312,1.0,18.0,6.0,0.0]\t1.0\t4.479227052264021\n0\t110.47\t2\t5\t2\t6\t48.0\t3\t[0.0,110.47000122070312,2.0,5.0,2.0,6.0]\t48.0\t40.49663118249314\n0\t110.48\t2\t18\t3\t2\t67.0\t4\t[0.0,110.4800033569336,2.0,18.0,3.0,2.0]\t67.0\t62.708019668924116\n0\t110.48\t2\t46\t10\t0\t38.0\t3\t[0.0,110.4800033569336,2.0,46.0,10.0,0.0]\t38.0\t57.950767536718274\n0\t110.49\t2\t9\t8\t5\t82.0\t4\t[0.0,110.48999786376953,2.0,9.0,8.0,5.0]\t82.0\t62.51874814074026\n0\t110.49\t2\t39\t6\t0\t59.0\t3\t[0.0,110.48999786376953,2.0,39.0,6.0,0.0]\t59.0\t70.69016939851163\n0\t110.5\t4\t4\t9\t2\t32.0\t3\t[0.0,110.5,4.0,4.0,9.0,2.0]\t32.0\t40.49663118249314\n0\t110.51\t0\t18\t2\t1\t4.0\t1\t[0.0,110.51000213623047,0.0,18.0,2.0,1.0]\t4.0\t4.479227052264021\n0\t110.51\t4\t45\t9\t1\t117.0\t4\t[0.0,110.51000213623047,4.0,45.0,9.0,1.0]\t117.0\t57.80844172521356\n0\t110.53\t1\t5\t6\t3\t45.0\t3\t[0.0,110.52999877929688,1.0,5.0,6.0,3.0]\t45.0\t31.6550038573384\n0\t110.54\t2\t21\t3\t4\t44.0\t3\t[0.0,110.54000091552734,2.0,21.0,3.0,4.0]\t44.0\t59.832366571948064\n0\t110.54\t3\t4\t10\t5\t18.0\t2\t[0.0,110.54000091552734,3.0,4.0,10.0,5.0]\t18.0\t40.49663118249314\n0\t110.54\t3\t21\t6\t1\t18.0\t2\t[0.0,110.54000091552734,3.0,21.0,6.0,1.0]\t18.0\t59.832366571948064\n0\t110.55\t0\t23\t8\t2\t1.0\t1\t[0.0,110.55000305175781,0.0,23.0,8.0,2.0]\t1.0\t8.218474047248439\n0\t110.55\t0\t39\t4\t6\t5.0\t1\t[0.0,110.55000305175781,0.0,39.0,4.0,6.0]\t5.0\t5.353254811111062\n0\t110.55\t2\t21\t11\t0\t63.0\t4\t[0.0,110.55000305175781,2.0,21.0,11.0,0.0]\t63.0\t59.832366571948064\n0\t110.55\t2\t28\t4\t0\t25.0\t2\t[0.0,110.55000305175781,2.0,28.0,4.0,0.0]\t25.0\t59.7929101342601\n0\t110.56\t0\t42\t3\t4\t5.0\t1\t[0.0,110.55999755859375,0.0,42.0,3.0,4.0]\t5.0\t18.120140872742773\n0\t110.56\t2\t29\t6\t1\t8.0\t2\t[0.0,110.55999755859375,2.0,29.0,6.0,1.0]\t8.0\t31.975369673412512\n0\t110.57\t1\t29\t5\t0\t10.0\t2\t[0.0,110.56999969482422,1.0,29.0,5.0,0.0]\t10.0\t5.946514676160504\n0\t110.57\t2\t1\t9\t5\t77.0\t4\t[0.0,110.56999969482422,2.0,1.0,9.0,5.0]\t77.0\t74.27875170340691\n0\t110.57\t2\t3\t2\t5\t83.0\t4\t[0.0,110.56999969482422,2.0,3.0,2.0,5.0]\t83.0\t40.49663118249314\n0\t110.58\t1\t47\t5\t0\t3.0\t1\t[0.0,110.58000183105469,1.0,47.0,5.0,0.0]\t3.0\t5.350837770744928\n0\t110.58\t3\t48\t3\t0\t125.0\t4\t[0.0,110.58000183105469,3.0,48.0,3.0,0.0]\t125.0\t69.66570208387161\n0\t110.59\t3\t9\t8\t0\t102.0\t4\t[0.0,110.58999633789062,3.0,9.0,8.0,0.0]\t102.0\t62.51874814074026\n0\t110.62\t1\t28\t3\t3\t2.0\t1\t[0.0,110.62000274658203,1.0,28.0,3.0,3.0]\t2.0\t6.96397079045418\n0\t110.62\t2\t1\t6\t4\t64.0\t4\t[0.0,110.62000274658203,2.0,1.0,6.0,4.0]\t64.0\t72.18882837010115\n0\t110.62\t3\t37\t9\t3\t85.0\t4\t[0.0,110.62000274658203,3.0,37.0,9.0,3.0]\t85.0\t70.69016939851163\n0\t110.62\t4\t6\t8\t0\t10.0\t2\t[0.0,110.62000274658203,4.0,6.0,8.0,0.0]\t10.0\t20.635731058573427\n0\t110.63\t0\t8\t10\t3\t2.0\t1\t[0.0,110.62999725341797,0.0,8.0,10.0,3.0]\t2.0\t7.635717841057315\n0\t110.63\t0\t39\t2\t2\t1.0\t1\t[0.0,110.62999725341797,0.0,39.0,2.0,2.0]\t1.0\t5.353254811111062\n0\t110.63\t1\t18\t4\t1\t1.0\t1\t[0.0,110.62999725341797,1.0,18.0,4.0,1.0]\t1.0\t4.479227052264021\n0\t110.63\t1\t30\t2\t6\t6.0\t1\t[0.0,110.62999725341797,1.0,30.0,2.0,6.0]\t6.0\t6.6675243430901086\n0\t110.63\t1\t30\t4\t1\t4.0\t1\t[0.0,110.62999725341797,1.0,30.0,4.0,1.0]\t4.0\t6.6675243430901086\n0\t110.63\t2\t38\t6\t6\t27.0\t2\t[0.0,110.62999725341797,2.0,38.0,6.0,6.0]\t27.0\t70.69016939851163\n0\t110.63\t3\t30\t3\t6\t171.0\t4\t[0.0,110.62999725341797,3.0,30.0,3.0,6.0]\t171.0\t54.241170546622214\n0\t110.64\t2\t30\t6\t2\t88.0\t4\t[0.0,110.63999938964844,2.0,30.0,6.0,2.0]\t88.0\t54.92375525771271\n0\t110.65\t3\t20\t2\t1\t6.0\t1\t[0.0,110.6500015258789,3.0,20.0,2.0,1.0]\t6.0\t21.45596098108056\n0\t110.65\t4\t10\t2\t3\t139.0\t4\t[0.0,110.6500015258789,4.0,10.0,2.0,3.0]\t139.0\t64.93416961964402\n0\t110.65\t4\t49\t2\t3\t73.0\t4\t[0.0,110.6500015258789,4.0,49.0,2.0,3.0]\t73.0\t69.66570208387161\n0\t110.66\t1\t7\t4\t2\t7.0\t1\t[0.0,110.66000366210938,1.0,7.0,4.0,2.0]\t7.0\t6.4583271016258195\n0\t110.66\t2\t0\t5\t4\t92.0\t4\t[0.0,110.66000366210938,2.0,0.0,5.0,4.0]\t92.0\t71.34490707544384\n0\t110.66\t2\t39\t8\t2\t24.0\t2\t[0.0,110.66000366210938,2.0,39.0,8.0,2.0]\t24.0\t70.69016939851163\n0\t110.67\t2\t32\t12\t3\t25.0\t2\t[0.0,110.66999816894531,2.0,32.0,12.0,3.0]\t25.0\t57.712134879518054\n0\t110.67\t2\t35\t12\t5\t60.0\t3\t[0.0,110.66999816894531,2.0,35.0,12.0,5.0]\t60.0\t59.32814284747064\n0\t110.68\t3\t19\t3\t2\t9.0\t2\t[0.0,110.68000030517578,3.0,19.0,3.0,2.0]\t9.0\t16.894013153089936\n0\t110.68\t5\t3\t2\t6\t45.0\t3\t[0.0,110.68000030517578,5.0,3.0,2.0,6.0]\t45.0\t40.49663118249314\n0\t110.69\t1\t1\t9\t0\t8.0\t2\t[0.0,110.69000244140625,1.0,1.0,9.0,0.0]\t8.0\t5.651791861760737\n0\t110.69\t1\t2\t3\t4\t17.0\t2\t[0.0,110.69000244140625,1.0,2.0,3.0,4.0]\t17.0\t41.06479319243391\n0\t110.69\t1\t26\t8\t2\t10.0\t2\t[0.0,110.69000244140625,1.0,26.0,8.0,2.0]\t10.0\t11.014882411815488\n0\t110.69\t1\t26\t12\t1\t12.0\t2\t[0.0,110.69000244140625,1.0,26.0,12.0,1.0]\t12.0\t11.014882411815488\n0\t110.7\t0\t1\t11\t1\t8.0\t2\t[0.0,110.69999694824219,0.0,1.0,11.0,1.0]\t8.0\t4.841603700760754\n0\t110.7\t0\t47\t9\t6\t4.0\t1\t[0.0,110.69999694824219,0.0,47.0,9.0,6.0]\t4.0\t5.350837770744928\n0\t110.7\t1\t38\t1\t4\t7.0\t1\t[0.0,110.69999694824219,1.0,38.0,1.0,4.0]\t7.0\t5.353254811111062\n0\t110.7\t1\t40\t5\t5\t8.0\t2\t[0.0,110.69999694824219,1.0,40.0,5.0,5.0]\t8.0\t5.353254811111062\n0\t110.71\t0\t30\t7\t1\t3.0\t1\t[0.0,110.70999908447266,0.0,30.0,7.0,1.0]\t3.0\t6.6675243430901086\n0\t110.71\t2\t6\t12\t1\t10.0\t2\t[0.0,110.70999908447266,2.0,6.0,12.0,1.0]\t10.0\t20.635731058573427\n0\t110.71\t2\t45\t3\t1\t89.0\t4\t[0.0,110.70999908447266,2.0,45.0,3.0,1.0]\t89.0\t57.80844172521356\n0\t110.71\t3\t14\t3\t6\t27.0\t2\t[0.0,110.70999908447266,3.0,14.0,3.0,6.0]\t27.0\t50.68334241748679\n0\t110.72\t0\t6\t6\t5\t7.0\t1\t[0.0,110.72000122070312,0.0,6.0,6.0,5.0]\t7.0\t6.859364794182818\n0\t110.72\t1\t19\t2\t2\t14.0\t2\t[0.0,110.72000122070312,1.0,19.0,2.0,2.0]\t14.0\t6.989402129830357\n0\t110.72\t1\t26\t5\t0\t8.0\t2\t[0.0,110.72000122070312,1.0,26.0,5.0,0.0]\t8.0\t11.014882411815488\n0\t110.72\t1\t38\t8\t2\t6.0\t1\t[0.0,110.72000122070312,1.0,38.0,8.0,2.0]\t6.0\t5.353254811111062\n0\t110.72\t2\t16\t6\t0\t22.0\t2\t[0.0,110.72000122070312,2.0,16.0,6.0,0.0]\t22.0\t67.24868126774062\n0\t110.72\t3\t37\t10\t3\t44.0\t3\t[0.0,110.72000122070312,3.0,37.0,10.0,3.0]\t44.0\t70.69016939851163\n0\t110.73\t1\t14\t7\t5\t59.0\t3\t[0.0,110.7300033569336,1.0,14.0,7.0,5.0]\t59.0\t25.617054762749177\n0\t110.73\t2\t26\t10\t0\t11.0\t2\t[0.0,110.7300033569336,2.0,26.0,10.0,0.0]\t11.0\t25.11520730136437\n0\t110.73\t2\t29\t8\t2\t13.0\t2\t[0.0,110.7300033569336,2.0,29.0,8.0,2.0]\t13.0\t31.975369673412512\n0\t110.73\t3\t36\t2\t6\t27.0\t2\t[0.0,110.7300033569336,3.0,36.0,2.0,6.0]\t27.0\t70.69016939851163\n0\t110.74\t2\t27\t4\t4\t27.0\t2\t[0.0,110.73999786376953,2.0,27.0,4.0,4.0]\t27.0\t41.98657161191299\n0\t110.75\t3\t2\t11\t3\t39.0\t3\t[0.0,110.75,3.0,2.0,11.0,3.0]\t39.0\t37.69221943528926\n0\t110.75\t3\t7\t6\t5\t7.0\t1\t[0.0,110.75,3.0,7.0,6.0,5.0]\t7.0\t20.23469336601643\n0\t110.76\t0\t26\t11\t3\t7.0\t1\t[0.0,110.76000213623047,0.0,26.0,11.0,3.0]\t7.0\t11.014882411815488\n0\t110.76\t1\t44\t3\t2\t4.0\t1\t[0.0,110.76000213623047,1.0,44.0,3.0,2.0]\t4.0\t18.443126351243336\n0\t110.76\t2\t49\t11\t5\t64.0\t4\t[0.0,110.76000213623047,2.0,49.0,11.0,5.0]\t64.0\t69.73317999717742\n0\t110.76\t4\t10\t9\t3\t55.0\t3\t[0.0,110.76000213623047,4.0,10.0,9.0,3.0]\t55.0\t64.93416961964402\n0\t110.76\t4\t14\t11\t3\t55.0\t3\t[0.0,110.76000213623047,4.0,14.0,11.0,3.0]\t55.0\t50.68334241748679\n0\t110.76\t4\t43\t9\t4\t22.0\t2\t[0.0,110.76000213623047,4.0,43.0,9.0,4.0]\t22.0\t58.322934598397836\n0\t110.77\t0\t24\t6\t3\t8.0\t2\t[0.0,110.7699966430664,0.0,24.0,6.0,3.0]\t8.0\t8.218474047248439\n0\t110.77\t1\t21\t10\t2\t6.0\t1\t[0.0,110.7699966430664,1.0,21.0,10.0,2.0]\t6.0\t7.547680408543344\n0\t110.77\t1\t25\t3\t4\t1.0\t1\t[0.0,110.7699966430664,1.0,25.0,3.0,4.0]\t1.0\t5.649836191657455\n0\t110.77\t2\t41\t10\t1\t79.0\t4\t[0.0,110.7699966430664,2.0,41.0,10.0,1.0]\t79.0\t70.75764731181744\n0\t110.78\t1\t37\t3\t5\t9.0\t2\t[0.0,110.77999877929688,1.0,37.0,3.0,5.0]\t9.0\t5.420732724416858\n0\t110.78\t2\t40\t6\t2\t15.0\t2\t[0.0,110.77999877929688,2.0,40.0,6.0,2.0]\t15.0\t70.75764731181744\n0\t110.79\t0\t13\t9\t5\t11.0\t2\t[0.0,110.79000091552734,0.0,13.0,9.0,5.0]\t11.0\t7.706881936888375\n0\t110.79\t2\t7\t8\t2\t13.0\t2\t[0.0,110.79000091552734,2.0,7.0,8.0,2.0]\t13.0\t20.23469336601643\n0\t110.79\t3\t32\t13\t1\t36.0\t3\t[0.0,110.79000091552734,3.0,32.0,13.0,1.0]\t36.0\t58.064339452367065\n0\t110.8\t0\t26\t6\t3\t8.0\t2\t[0.0,110.80000305175781,0.0,26.0,6.0,3.0]\t8.0\t11.014882411815488\n0\t110.8\t0\t46\t4\t1\t37.0\t3\t[0.0,110.80000305175781,0.0,46.0,4.0,1.0]\t37.0\t19.10647892825916\n0\t110.8\t1\t47\t4\t1\t2.0\t1\t[0.0,110.80000305175781,1.0,47.0,4.0,1.0]\t2.0\t5.418315684050724\n0\t110.81\t2\t6\t10\t3\t9.0\t2\t[0.0,110.80999755859375,2.0,6.0,10.0,3.0]\t9.0\t20.635731058573427\n0\t110.81\t2\t48\t7\t2\t33.0\t3\t[0.0,110.80999755859375,2.0,48.0,7.0,2.0]\t33.0\t69.73317999717742\n0\t110.81\t3\t2\t5\t2\t41.0\t3\t[0.0,110.80999755859375,3.0,2.0,5.0,2.0]\t41.0\t37.69221943528926\n0\t110.82\t1\t44\t7\t6\t9.0\t2\t[0.0,110.81999969482422,1.0,44.0,7.0,6.0]\t9.0\t18.443126351243336\n0\t110.82\t2\t15\t6\t4\t12.0\t2\t[0.0,110.81999969482422,2.0,15.0,6.0,4.0]\t12.0\t58.880968951035165\n0\t110.82\t2\t44\t8\t6\t151.0\t4\t[0.0,110.81999969482422,2.0,44.0,8.0,6.0]\t151.0\t58.322934598397836\n0\t110.82\t3\t48\t4\t3\t31.0\t3\t[0.0,110.81999969482422,3.0,48.0,4.0,3.0]\t31.0\t69.73317999717742\n0\t110.83\t1\t9\t8\t3\t7.0\t1\t[0.0,110.83000183105469,1.0,9.0,8.0,3.0]\t7.0\t7.63436557062298\n0\t110.83\t3\t19\t5\t0\t10.0\t2\t[0.0,110.83000183105469,3.0,19.0,5.0,0.0]\t10.0\t16.894013153089936\n0\t110.84\t0\t8\t3\t0\t3.0\t1\t[0.0,110.83999633789062,0.0,8.0,3.0,0.0]\t3.0\t7.635717841057315\n0\t110.84\t0\t43\t12\t2\t42.0\t3\t[0.0,110.83999633789062,0.0,43.0,12.0,2.0]\t42.0\t18.443126351243336\n0\t110.84\t1\t1\t2\t4\t6.0\t1\t[0.0,110.83999633789062,1.0,1.0,2.0,4.0]\t6.0\t5.651791861760737\n0\t110.84\t1\t42\t3\t6\t10.0\t2\t[0.0,110.83999633789062,1.0,42.0,3.0,6.0]\t10.0\t18.187618786048567\n0\t110.84\t3\t10\t6\t4\t15.0\t2\t[0.0,110.83999633789062,3.0,10.0,6.0,4.0]\t15.0\t64.93416961964402\n0\t110.84\t3\t32\t8\t4\t77.0\t4\t[0.0,110.83999633789062,3.0,32.0,8.0,4.0]\t77.0\t58.064339452367065\n0\t110.84\t4\t30\t9\t1\t13.0\t2\t[0.0,110.83999633789062,4.0,30.0,9.0,1.0]\t13.0\t54.92375525771271\n0\t110.84\t4\t32\t2\t2\t34.0\t3\t[0.0,110.83999633789062,4.0,32.0,2.0,2.0]\t34.0\t58.064339452367065\n0\t110.85\t1\t48\t3\t2\t4.0\t1\t[0.0,110.8499984741211,1.0,48.0,3.0,2.0]\t4.0\t5.418315684050724\n0\t110.85\t2\t0\t2\t3\t67.0\t4\t[0.0,110.8499984741211,2.0,0.0,2.0,3.0]\t67.0\t71.34490707544384\n0\t110.85\t2\t41\t9\t4\t52.0\t3\t[0.0,110.8499984741211,2.0,41.0,9.0,4.0]\t52.0\t70.75764731181744\n0\t110.85\t3\t29\t12\t0\t8.0\t2\t[0.0,110.8499984741211,3.0,29.0,12.0,0.0]\t8.0\t31.975369673412512\n0\t110.85\t3\t43\t8\t1\t47.0\t3\t[0.0,110.8499984741211,3.0,43.0,8.0,1.0]\t47.0\t58.322934598397836\n0\t110.85\t5\t48\t3\t4\t21.0\t2\t[0.0,110.8499984741211,5.0,48.0,3.0,4.0]\t21.0\t69.73317999717742\n0\t110.86\t0\t13\t11\t2\t5.0\t1\t[0.0,110.86000061035156,0.0,13.0,11.0,2.0]\t5.0\t7.706881936888375\n0\t110.86\t0\t19\t3\t3\t5.0\t1\t[0.0,110.86000061035156,0.0,19.0,3.0,3.0]\t5.0\t7.0326070656227975\n0\t110.86\t3\t49\t6\t4\t16.0\t2\t[0.0,110.86000061035156,3.0,49.0,6.0,4.0]\t16.0\t69.73317999717742\n0\t110.87\t1\t11\t6\t0\t2.0\t1\t[0.0,110.87000274658203,1.0,11.0,6.0,0.0]\t2.0\t7.242828103372639\n0\t110.87\t4\t46\t4\t5\t63.0\t4\t[0.0,110.87000274658203,4.0,46.0,4.0,5.0]\t63.0\t58.01824545002407\n0\t110.88\t1\t3\t8\t0\t11.0\t2\t[0.0,110.87999725341797,1.0,3.0,8.0,0.0]\t11.0\t26.915380890463545\n0\t110.88\t2\t21\t3\t2\t57.0\t3\t[0.0,110.87999725341797,2.0,21.0,3.0,2.0]\t57.0\t59.832366571948064\n0\t110.88\t2\t28\t9\t6\t97.0\t4\t[0.0,110.87999725341797,2.0,28.0,9.0,6.0]\t97.0\t59.7929101342601\n0\t110.88\t2\t43\t10\t2\t39.0\t3\t[0.0,110.87999725341797,2.0,43.0,10.0,2.0]\t39.0\t58.322934598397836\n0\t110.88\t2\t48\t5\t3\t36.0\t3\t[0.0,110.87999725341797,2.0,48.0,5.0,3.0]\t36.0\t69.73317999717742\n0\t110.88\t3\t25\t5\t0\t37.0\t3\t[0.0,110.87999725341797,3.0,25.0,5.0,0.0]\t37.0\t60.78781100386247\n0\t110.88\t4\t12\t3\t4\t8.0\t2\t[0.0,110.87999725341797,4.0,12.0,3.0,4.0]\t8.0\t33.18169311798354\n0\t110.88\t4\t42\t1\t0\t81.0\t4\t[0.0,110.87999725341797,4.0,42.0,1.0,0.0]\t81.0\t58.06742703320306\n0\t110.89\t1\t46\t6\t5\t22.0\t2\t[0.0,110.88999938964844,1.0,46.0,6.0,5.0]\t22.0\t19.10647892825916\n0\t110.89\t2\t26\t3\t4\t10.0\t2\t[0.0,110.88999938964844,2.0,26.0,3.0,4.0]\t10.0\t25.11520730136437\n0\t110.89\t2\t37\t8\t0\t101.0\t4\t[0.0,110.88999938964844,2.0,37.0,8.0,0.0]\t101.0\t70.75764731181744\n0\t110.9\t1\t10\t3\t3\t2.0\t1\t[0.0,110.9000015258789,1.0,10.0,3.0,3.0]\t2.0\t8.028380817338704\n0\t110.9\t2\t3\t4\t5\t43.0\t3\t[0.0,110.9000015258789,2.0,3.0,4.0,5.0]\t43.0\t40.49663118249314\n0\t110.9\t2\t3\t8\t1\t117.0\t4\t[0.0,110.9000015258789,2.0,3.0,8.0,1.0]\t117.0\t40.49663118249314\n0\t110.9\t3\t16\t12\t0\t83.0\t4\t[0.0,110.9000015258789,3.0,16.0,12.0,0.0]\t83.0\t67.24868126774062\n0\t110.9\t4\t31\t7\t6\t11.0\t2\t[0.0,110.9000015258789,4.0,31.0,7.0,6.0]\t11.0\t27.498838125764788\n0\t110.91\t0\t26\t3\t2\t6.0\t1\t[0.0,110.91000366210938,0.0,26.0,3.0,2.0]\t6.0\t11.014882411815488\n0\t110.91\t0\t29\t4\t4\t7.0\t1\t[0.0,110.91000366210938,0.0,29.0,4.0,4.0]\t7.0\t5.946514676160504\n0\t110.91\t0\t48\t9\t3\t1.0\t1\t[0.0,110.91000366210938,0.0,48.0,9.0,3.0]\t1.0\t5.418315684050724\n0\t110.91\t3\t28\t2\t4\t60.0\t3\t[0.0,110.91000366210938,3.0,28.0,2.0,4.0]\t60.0\t59.21845739561287\n0\t110.92\t1\t0\t12\t3\t4.0\t1\t[0.0,110.91999816894531,1.0,0.0,12.0,3.0]\t4.0\t4.74604103813765\n0\t110.92\t1\t25\t8\t3\t2.0\t1\t[0.0,110.91999816894531,1.0,25.0,8.0,3.0]\t2.0\t5.649836191657455\n0\t110.93\t1\t0\t9\t3\t7.0\t1\t[0.0,110.93000030517578,1.0,0.0,9.0,3.0]\t7.0\t5.556229199137633\n0\t110.93\t1\t49\t3\t1\t6.0\t1\t[0.0,110.93000030517578,1.0,49.0,3.0,1.0]\t6.0\t5.418315684050724\n0\t110.93\t2\t40\t2\t3\t32.0\t3\t[0.0,110.93000030517578,2.0,40.0,2.0,3.0]\t32.0\t70.75764731181744\n0\t110.94\t0\t3\t4\t6\t7.0\t1\t[0.0,110.94000244140625,0.0,3.0,4.0,6.0]\t7.0\t26.915380890463545\n0\t110.94\t0\t15\t3\t6\t1.0\t1\t[0.0,110.94000244140625,0.0,15.0,3.0,6.0]\t1.0\t15.393227241971028\n0\t110.94\t0\t16\t10\t3\t11.0\t2\t[0.0,110.94000244140625,0.0,16.0,10.0,3.0]\t11.0\t7.895952953811472\n0\t110.94\t1\t40\t4\t6\t5.0\t1\t[0.0,110.94000244140625,1.0,40.0,4.0,6.0]\t5.0\t5.420732724416858\n"}]},"apps":[],"jobName":"paragraph_1493681262219_-180467283","id":"20170501-161000_1485645350","dateCreated":"2017-05-01T23:27:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:210","user":"anonymous","dateFinished":"2017-05-02T02:24:42+0000","dateStarted":"2017-05-02T02:24:11+0000"},{"title":"Modeling - RandomForest (Classifier)","text":"%spark2.pyspark\n\nmodelprep1 = va.transform(transformed1).withColumn(\"label\", col(\"days_until_arrival_cat\"))\ntraining, testing = modelprep1.randomSplit([0.8, 0.2])\n\nrf = RandomForestClassifier(featuresCol=\"features\", labelCol=\"label\", predictionCol=\"prediction\", numTrees=3, maxDepth=2, seed=12345)\n\nrfmodel = rf.fit(training)\n\nrfmodel.featureImportances\n\npredictions = rfmodel.transform(testing)\n\npredictions.select(\"prediction\", \"label\").show(30,False)","dateUpdated":"2017-05-02T02:27:39+0000","config":{"editorSetting":{"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------+-----+\n|prediction|label|\n+----------+-----+\n|1.0       |1    |\n|4.0       |4    |\n|4.0       |2    |\n|4.0       |4    |\n|1.0       |1    |\n|4.0       |4    |\n|1.0       |1    |\n|4.0       |4    |\n|1.0       |1    |\n|4.0       |2    |\n|4.0       |3    |\n|1.0       |2    |\n|4.0       |4    |\n|1.0       |1    |\n|1.0       |2    |\n|1.0       |1    |\n|4.0       |2    |\n|4.0       |4    |\n|1.0       |1    |\n|1.0       |2    |\n|1.0       |1    |\n|4.0       |4    |\n|4.0       |3    |\n|1.0       |1    |\n|4.0       |2    |\n|1.0       |1    |\n|4.0       |4    |\n|1.0       |1    |\n|4.0       |4    |\n|4.0       |2    |\n+----------+-----+\nonly showing top 30 rows\n\n"}]},"apps":[],"jobName":"paragraph_1493681262219_-180467283","id":"20170428-140000_879396384","dateCreated":"2017-05-01T23:27:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:211","user":"anonymous","dateFinished":"2017-05-02T02:31:23+0000","dateStarted":"2017-05-02T02:27:39+0000"},{"title":"Kmeans Clustering (Unsupervised)","text":"%spark2.pyspark\n\nfrom pyspark.ml.clustering import KMeans\n\nkmeans = KMeans(k=10, seed=12345)\n\nkmeans_model = kmeans.fit(training)\n\ncenters = kmeans_model.clusterCenters()\n\nlen(centers)\n\ntransformed = kmeans_model.transform(testing).select(\"features\", \"prediction\")\n\ntransformed.show(25,False)","dateUpdated":"2017-05-02T03:19:05+0000","config":{"editorSetting":{"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------------------------------------+----------+\n|features                                  |prediction|\n+------------------------------------------+----------+\n|[0.0,110.04000091552734,0.0,44.0,3.0,4.0] |5         |\n|[0.0,110.11000061035156,2.0,37.0,11.0,4.0]|5         |\n|[0.0,110.1500015258789,3.0,8.0,2.0,3.0]   |3         |\n|[0.0,110.16999816894531,2.0,23.0,3.0,1.0] |3         |\n|[0.0,110.18000030517578,0.0,25.0,8.0,0.0] |3         |\n|[0.0,110.19999694824219,2.0,18.0,3.0,0.0] |3         |\n|[0.0,110.20999908447266,1.0,21.0,9.0,2.0] |3         |\n|[0.0,110.22000122070312,3.0,17.0,2.0,2.0] |3         |\n|[0.0,110.23999786376953,1.0,24.0,7.0,2.0] |3         |\n|[0.0,110.23999786376953,3.0,30.0,6.0,3.0] |5         |\n|[0.0,110.23999786376953,4.0,32.0,8.0,5.0] |5         |\n|[0.0,110.25,1.0,31.0,6.0,3.0]             |5         |\n|[0.0,110.25,3.0,25.0,4.0,3.0]             |3         |\n|[0.0,110.27999877929688,1.0,10.0,9.0,1.0] |3         |\n|[0.0,110.27999877929688,1.0,31.0,9.0,3.0] |5         |\n|[0.0,110.30000305175781,1.0,34.0,4.0,3.0] |5         |\n|[0.0,110.31999969482422,2.0,4.0,5.0,1.0]  |3         |\n|[0.0,110.31999969482422,2.0,42.0,9.0,3.0] |5         |\n|[0.0,110.33000183105469,0.0,30.0,7.0,3.0] |5         |\n|[0.0,110.33000183105469,0.0,41.0,6.0,2.0] |5         |\n|[0.0,110.33000183105469,1.0,13.0,3.0,5.0] |3         |\n|[0.0,110.33000183105469,2.0,0.0,10.0,0.0] |3         |\n|[0.0,110.33000183105469,2.0,36.0,11.0,6.0]|5         |\n|[0.0,110.3499984741211,1.0,13.0,3.0,1.0]  |3         |\n|[0.0,110.3499984741211,2.0,29.0,6.0,5.0]  |5         |\n+------------------------------------------+----------+\nonly showing top 25 rows\n\n"}]},"apps":[],"jobName":"paragraph_1493681262220_-182391027","id":"20170428-140114_220238210","dateCreated":"2017-05-01T23:27:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:212","user":"anonymous","dateFinished":"2017-05-02T03:34:45+0000","dateStarted":"2017-05-02T03:19:05+0000"},{"text":"%spark2.pyspark\n","dateUpdated":"2017-05-02T01:03:31+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"},"editorHide":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1493681262221_-182775776","id":"20170501-172956_2142338261","dateCreated":"2017-05-01T23:27:42+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:214"}],"name":"Disney_ML","id":"2CFHWGZVM","angularObjects":{"2CFY9KRTF:shared_process":[],"2C8A4SZ9T_livy2:shared_process":[],"2CF23SSUS:shared_process":[],"2CEE2CWEY:shared_process":[],"2CGMF23WM:shared_process":[],"2CFGJU6ZR:shared_process":[],"2C4U48MY3_spark2:shared_process":[],"2CH3M43DS:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}