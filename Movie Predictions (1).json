{"paragraphs":[{"title":"Import Libraries","text":"%pyspark\n\nimport datetime, time \nimport re, random, sys\nfrom pyspark.sql.types import *\nfrom pyspark.sql.functions import *\nfrom pyspark.sql.functions import monotonically_increasing_id, col, expr, when, concat, lit, udf, split\nfrom pyspark.ml.linalg import Vectors\nfrom pyspark.ml.regression import GBTRegressor, LinearRegression, GeneralizedLinearRegression, RandomForestRegressor\nfrom pyspark.ml.classification import GBTClassifier, RandomForestClassifier\nfrom pyspark.ml.feature import VectorIndexer, VectorAssembler, StringIndexer\nfrom pyspark.ml.evaluation import RegressionEvaluator\nfrom pyspark.ml import Pipeline\nfrom pyspark.ml.evaluation import MulticlassClassificationEvaluator, RegressionEvaluator\nfrom pyspark.ml.feature import HashingTF, IDF, Tokenizer, CountVectorizer\nfrom pyspark.ml.clustering import LDA, BisectingKMeans\n#import nltk\n#import spacy \n#nlp = spacy.load(\"en\")\n#import sparknlp.annotators as sparknlp\nsc.setLogLevel(\"ERROR\")","user":"anonymous","dateUpdated":"2017-10-02T23:17:03+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","title":true,"editorHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1506986160797_-1657402545","id":"20171002-231600_106801054","dateCreated":"2017-10-02T23:16:00+0000","dateStarted":"2017-10-02T23:16:07+0000","dateFinished":"2017-10-02T23:16:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:124"},{"title":"Load Rawdata","text":"%pyspark\n\n############################################################################################################\n#\n#   Load Rawdata\n#   Source: https://www.kaggle.com/tmdb/tmdb-movie-metadata\n#\n############################################################################################################\n\nschema = StructType([                                           \\\n    StructField(\"budget\", IntegerType(), True),                 \\\n    StructField(\"genres\", StringType(), True),                  \\\n    StructField(\"homepage\", StringType(), True),                \\\n    StructField(\"id\", StringType(), True),                      \\\n    StructField(\"keywords\", StringType(), True),                \\\n    StructField(\"original_language\", StringType(), True),       \\\n    StructField(\"original_title\", StringType(), True),          \\\n    StructField(\"overview\", StringType(), True),                \\\n    StructField(\"popularity\", FloatType(), True),               \\\n    StructField(\"production_companies\", StringType(), True),    \\\n    StructField(\"production_countries\", StringType(), True),    \\\n    StructField(\"release_date\", StringType(), True),            \\\n    StructField(\"revenue\", LongType(), True),                   \\\n    StructField(\"runtime\", IntegerType(), True),                \\\n    StructField(\"spoken_languages\", StringType(), True),        \\\n    StructField(\"status\", StringType(), True),                  \\\n    StructField(\"tagline\", StringType(), True),                 \\\n    StructField(\"title\", StringType(), True),                   \\\n    StructField(\"vote_average\", FloatType(), True),             \\\n    StructField(\"vote_count\", IntegerType(), True)])\n\nrawdata = spark.read.format('csv').load('hdfs://dzaratsian0.field.hortonworks.com:8020/tmp/tmdb_5000_movies.csv', format=\"csv\", header=True, schema=schema, quote='\"', escape='\"', mode=\"DROPMALFORMED\")\n\nrawdata.createOrReplaceTempView('rawdata')","user":"anonymous","dateUpdated":"2017-10-02T23:39:44+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python","tableHide":false,"title":true,"editorHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1506882547911_-1500892508","id":"20171001-182907_522031746","dateCreated":"2017-10-01T18:29:07+0000","dateStarted":"2017-10-02T23:19:23+0000","dateFinished":"2017-10-02T23:19:23+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:125"},{"title":"Display Rawdata","text":"%sql\n\nselect * from rawdata limit 20","user":"anonymous","dateUpdated":"2017-10-03T00:12:11+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/sql","title":true,"editorHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"budget\tgenres\thomepage\tid\tkeywords\toriginal_language\toriginal_title\toverview\tpopularity\tproduction_companies\tproduction_countries\trelease_date\trevenue\truntime\tspoken_languages\tstatus\ttagline\ttitle\tvote_average\tvote_count\n237000000\t[{\"id\": 28, \"name\": \"Action\"}, {\"id\": 12, \"name\": \"Adventure\"}, {\"id\": 14, \"name\": \"Fantasy\"}, {\"id\": 878, \"name\": \"Science Fiction\"}]\thttp://www.avatarmovie.com/\t19995\t[{\"id\": 1463, \"name\": \"culture clash\"}, {\"id\": 2964, \"name\": \"future\"}, {\"id\": 3386, \"name\": \"space war\"}, {\"id\": 3388, \"name\": \"space colony\"}, {\"id\": 3679, \"name\": \"society\"}, {\"id\": 3801, \"name\": \"space travel\"}, {\"id\": 9685, \"name\": \"futuristic\"}, {\"id\": 9840, \"name\": \"romance\"}, {\"id\": 9882, \"name\": \"space\"}, {\"id\": 9951, \"name\": \"alien\"}, {\"id\": 10148, \"name\": \"tribe\"}, {\"id\": 10158, \"name\": \"alien planet\"}, {\"id\": 10987, \"name\": \"cgi\"}, {\"id\": 11399, \"name\": \"marine\"}, {\"id\": 13065, \"name\": \"soldier\"}, {\"id\": 14643, \"name\": \"battle\"}, {\"id\": 14720, \"name\": \"love affair\"}, {\"id\": 165431, \"name\": \"anti war\"}, {\"id\": 193554, \"name\": \"power relations\"}, {\"id\": 206690, \"name\": \"mind and soul\"}, {\"id\": 209714, \"name\": \"3d\"}]\ten\tAvatar\tIn the 22nd century, a paraplegic Marine is dispatched to the moon Pandora on a unique mission, but becomes torn between following orders and protecting an alien civilization.\t150.43758\t[{\"name\": \"Ingenious Film Partners\", \"id\": 289}, {\"name\": \"Twentieth Century Fox Film Corporation\", \"id\": 306}, {\"name\": \"Dune Entertainment\", \"id\": 444}, {\"name\": \"Lightstorm Entertainment\", \"id\": 574}]\t[{\"iso_3166_1\": \"US\", \"name\": \"United States of America\"}, {\"iso_3166_1\": \"GB\", \"name\": \"United Kingdom\"}]\t2009-12-10\t2787965087\t162\t[{\"iso_639_1\": \"en\", \"name\": \"English\"}, {\"iso_639_1\": \"es\", \"name\": \"Espa\\u00f1ol\"}]\tReleased\tEnter the World of Pandora.\tAvatar\t7.2\t11800\n300000000\t[{\"id\": 12, \"name\": \"Adventure\"}, {\"id\": 14, \"name\": \"Fantasy\"}, {\"id\": 28, \"name\": \"Action\"}]\thttp://disney.go.com/disneypictures/pirates/\t285\t[{\"id\": 270, \"name\": \"ocean\"}, {\"id\": 726, \"name\": \"drug abuse\"}, {\"id\": 911, \"name\": \"exotic island\"}, {\"id\": 1319, \"name\": \"east india trading company\"}, {\"id\": 2038, \"name\": \"love of one's life\"}, {\"id\": 2052, \"name\": \"traitor\"}, {\"id\": 2580, \"name\": \"shipwreck\"}, {\"id\": 2660, \"name\": \"strong woman\"}, {\"id\": 3799, \"name\": \"ship\"}, {\"id\": 5740, \"name\": \"alliance\"}, {\"id\": 5941, \"name\": \"calypso\"}, {\"id\": 6155, \"name\": \"afterlife\"}, {\"id\": 6211, \"name\": \"fighter\"}, {\"id\": 12988, \"name\": \"pirate\"}, {\"id\": 157186, \"name\": \"swashbuckler\"}, {\"id\": 179430, \"name\": \"aftercreditsstinger\"}]\ten\tPirates of the Caribbean: At World's End\tCaptain Barbossa, long believed to be dead, has come back to life and is headed to the edge of the Earth with Will Turner and Elizabeth Swann. But nothing is quite as it seems.\t139.08261\t[{\"name\": \"Walt Disney Pictures\", \"id\": 2}, {\"name\": \"Jerry Bruckheimer Films\", \"id\": 130}, {\"name\": \"Second Mate Productions\", \"id\": 19936}]\t[{\"iso_3166_1\": \"US\", \"name\": \"United States of America\"}]\t2007-05-19\t961000000\t169\t[{\"iso_639_1\": \"en\", \"name\": \"English\"}]\tReleased\tAt the end of the world, the adventure begins.\tPirates of the Caribbean: At World's End\t6.9\t4500\n245000000\t[{\"id\": 28, \"name\": \"Action\"}, {\"id\": 12, \"name\": \"Adventure\"}, {\"id\": 80, \"name\": \"Crime\"}]\thttp://www.sonypictures.com/movies/spectre/\t206647\t[{\"id\": 470, \"name\": \"spy\"}, {\"id\": 818, \"name\": \"based on novel\"}, {\"id\": 4289, \"name\": \"secret agent\"}, {\"id\": 9663, \"name\": \"sequel\"}, {\"id\": 14555, \"name\": \"mi6\"}, {\"id\": 156095, \"name\": \"british secret service\"}, {\"id\": 158431, \"name\": \"united kingdom\"}]\ten\tSpectre\tA cryptic message from Bond’s past sends him on a trail to uncover a sinister organization. While M battles political forces to keep the secret service alive, Bond peels back the layers of deceit to reveal the terrible truth behind SPECTRE.\t107.376785\t[{\"name\": \"Columbia Pictures\", \"id\": 5}, {\"name\": \"Danjaq\", \"id\": 10761}, {\"name\": \"B24\", \"id\": 69434}]\t[{\"iso_3166_1\": \"GB\", \"name\": \"United Kingdom\"}, {\"iso_3166_1\": \"US\", \"name\": \"United States of America\"}]\t2015-10-26\t880674609\t148\t[{\"iso_639_1\": \"fr\", \"name\": \"Fran\\u00e7ais\"}, {\"iso_639_1\": \"en\", \"name\": \"English\"}, {\"iso_639_1\": \"es\", \"name\": \"Espa\\u00f1ol\"}, {\"iso_639_1\": \"it\", \"name\": \"Italiano\"}, {\"iso_639_1\": \"de\", \"name\": \"Deutsch\"}]\tReleased\tA Plan No One Escapes\tSpectre\t6.3\t4466\n250000000\t[{\"id\": 28, \"name\": \"Action\"}, {\"id\": 80, \"name\": \"Crime\"}, {\"id\": 18, \"name\": \"Drama\"}, {\"id\": 53, \"name\": \"Thriller\"}]\thttp://www.thedarkknightrises.com/\t49026\t[{\"id\": 849, \"name\": \"dc comics\"}, {\"id\": 853, \"name\": \"crime fighter\"}, {\"id\": 949, \"name\": \"terrorist\"}, {\"id\": 1308, \"name\": \"secret identity\"}, {\"id\": 1437, \"name\": \"burglar\"}, {\"id\": 3051, \"name\": \"hostage drama\"}, {\"id\": 3562, \"name\": \"time bomb\"}, {\"id\": 6969, \"name\": \"gotham city\"}, {\"id\": 7002, \"name\": \"vigilante\"}, {\"id\": 9665, \"name\": \"cover-up\"}, {\"id\": 9715, \"name\": \"superhero\"}, {\"id\": 9990, \"name\": \"villainess\"}, {\"id\": 10044, \"name\": \"tragic hero\"}, {\"id\": 13015, \"name\": \"terrorism\"}, {\"id\": 14796, \"name\": \"destruction\"}, {\"id\": 18933, \"name\": \"catwoman\"}, {\"id\": 156082, \"name\": \"cat burglar\"}, {\"id\": 156395, \"name\": \"imax\"}, {\"id\": 173272, \"name\": \"flood\"}, {\"id\": 179093, \"name\": \"criminal underworld\"}, {\"id\": 230775, \"name\": \"batman\"}]\ten\tThe Dark Knight Rises\tFollowing the death of District Attorney Harvey Dent, Batman assumes responsibility for Dent's crimes to protect the late attorney's reputation and is subsequently hunted by the Gotham City Police Department. Eight years later, Batman encounters the mysterious Selina Kyle and the villainous Bane, a new terrorist leader who overwhelms Gotham's finest. The Dark Knight resurfaces to protect a city that has branded him an enemy.\t112.31295\t[{\"name\": \"Legendary Pictures\", \"id\": 923}, {\"name\": \"Warner Bros.\", \"id\": 6194}, {\"name\": \"DC Entertainment\", \"id\": 9993}, {\"name\": \"Syncopy\", \"id\": 9996}]\t[{\"iso_3166_1\": \"US\", \"name\": \"United States of America\"}]\t2012-07-16\t1084939099\t165\t[{\"iso_639_1\": \"en\", \"name\": \"English\"}]\tReleased\tThe Legend Ends\tThe Dark Knight Rises\t7.6\t9106\n260000000\t[{\"id\": 28, \"name\": \"Action\"}, {\"id\": 12, \"name\": \"Adventure\"}, {\"id\": 878, \"name\": \"Science Fiction\"}]\thttp://movies.disney.com/john-carter\t49529\t[{\"id\": 818, \"name\": \"based on novel\"}, {\"id\": 839, \"name\": \"mars\"}, {\"id\": 1456, \"name\": \"medallion\"}, {\"id\": 3801, \"name\": \"space travel\"}, {\"id\": 7376, \"name\": \"princess\"}, {\"id\": 9951, \"name\": \"alien\"}, {\"id\": 10028, \"name\": \"steampunk\"}, {\"id\": 10539, \"name\": \"martian\"}, {\"id\": 10685, \"name\": \"escape\"}, {\"id\": 161511, \"name\": \"edgar rice burroughs\"}, {\"id\": 163252, \"name\": \"alien race\"}, {\"id\": 179102, \"name\": \"superhuman strength\"}, {\"id\": 190320, \"name\": \"mars civilization\"}, {\"id\": 195446, \"name\": \"sword and planet\"}, {\"id\": 207928, \"name\": \"19th century\"}, {\"id\": 209714, \"name\": \"3d\"}]\ten\tJohn Carter\tJohn Carter is a war-weary, former military captain who's inexplicably transported to the mysterious and exotic planet of Barsoom (Mars) and reluctantly becomes embroiled in an epic conflict. It's a world on the brink of collapse, and Carter rediscovers his humanity when he realizes the survival of Barsoom and its people rests in his hands.\t43.926994\t[{\"name\": \"Walt Disney Pictures\", \"id\": 2}]\t[{\"iso_3166_1\": \"US\", \"name\": \"United States of America\"}]\t2012-03-07\t284139100\t132\t[{\"iso_639_1\": \"en\", \"name\": \"English\"}]\tReleased\tLost in our world, found in another.\tJohn Carter\t6.1\t2124\n258000000\t[{\"id\": 14, \"name\": \"Fantasy\"}, {\"id\": 28, \"name\": \"Action\"}, {\"id\": 12, \"name\": \"Adventure\"}]\thttp://www.sonypictures.com/movies/spider-man3/\t559\t[{\"id\": 851, \"name\": \"dual identity\"}, {\"id\": 1453, \"name\": \"amnesia\"}, {\"id\": 1965, \"name\": \"sandstorm\"}, {\"id\": 2038, \"name\": \"love of one's life\"}, {\"id\": 3446, \"name\": \"forgiveness\"}, {\"id\": 3986, \"name\": \"spider\"}, {\"id\": 4391, \"name\": \"wretch\"}, {\"id\": 4959, \"name\": \"death of a friend\"}, {\"id\": 5776, \"name\": \"egomania\"}, {\"id\": 5789, \"name\": \"sand\"}, {\"id\": 5857, \"name\": \"narcism\"}, {\"id\": 6062, \"name\": \"hostility\"}, {\"id\": 8828, \"name\": \"marvel comic\"}, {\"id\": 9663, \"name\": \"sequel\"}, {\"id\": 9715, \"name\": \"superhero\"}, {\"id\": 9748, \"name\": \"revenge\"}]\ten\tSpider-Man 3\tThe seemingly invincible Spider-Man goes up against an all-new crop of villain – including the shape-shifting Sandman. While Spider-Man’s superpowers are altered by an alien organism, his alter ego, Peter Parker, deals with nemesis Eddie Brock and also gets caught up in a love triangle.\t115.699814\t[{\"name\": \"Columbia Pictures\", \"id\": 5}, {\"name\": \"Laura Ziskin Productions\", \"id\": 326}, {\"name\": \"Marvel Enterprises\", \"id\": 19551}]\t[{\"iso_3166_1\": \"US\", \"name\": \"United States of America\"}]\t2007-05-01\t890871626\t139\t[{\"iso_639_1\": \"en\", \"name\": \"English\"}, {\"iso_639_1\": \"fr\", \"name\": \"Fran\\u00e7ais\"}]\tReleased\tThe battle within.\tSpider-Man 3\t5.9\t3576\n260000000\t[{\"id\": 16, \"name\": \"Animation\"}, {\"id\": 10751, \"name\": \"Family\"}]\thttp://disney.go.com/disneypictures/tangled/\t38757\t[{\"id\": 1562, \"name\": \"hostage\"}, {\"id\": 2343, \"name\": \"magic\"}, {\"id\": 2673, \"name\": \"horse\"}, {\"id\": 3205, \"name\": \"fairy tale\"}, {\"id\": 4344, \"name\": \"musical\"}, {\"id\": 7376, \"name\": \"princess\"}, {\"id\": 10336, \"name\": \"animation\"}, {\"id\": 33787, \"name\": \"tower\"}, {\"id\": 155658, \"name\": \"blonde woman\"}, {\"id\": 162219, \"name\": \"selfishness\"}, {\"id\": 163545, \"name\": \"healing power\"}, {\"id\": 179411, \"name\": \"based on fairy tale\"}, {\"id\": 179431, \"name\": \"duringcreditsstinger\"}, {\"id\": 215258, \"name\": \"healing gift\"}, {\"id\": 234183, \"name\": \"animal sidekick\"}]\ten\tTangled\tWhen the kingdom's most wanted-and most charming-bandit Flynn Rider hides out in a mysterious tower, he's taken hostage by Rapunzel, a beautiful and feisty tower-bound teen with 70 feet of magical, golden hair. Flynn's curious captor, who's looking for her ticket out of the tower where she's been locked away for years, strikes a deal with the handsome thief and the unlikely duo sets off on an action-packed escapade, complete with a super-cop horse, an over-protective chameleon and a gruff gang of pub thugs.\t48.68197\t[{\"name\": \"Walt Disney Pictures\", \"id\": 2}, {\"name\": \"Walt Disney Animation Studios\", \"id\": 6125}]\t[{\"iso_3166_1\": \"US\", \"name\": \"United States of America\"}]\t2010-11-24\t591794936\t100\t[{\"iso_639_1\": \"en\", \"name\": \"English\"}]\tReleased\tThey're taking adventure to new lengths.\tTangled\t7.4\t3330\n280000000\t[{\"id\": 28, \"name\": \"Action\"}, {\"id\": 12, \"name\": \"Adventure\"}, {\"id\": 878, \"name\": \"Science Fiction\"}]\thttp://marvel.com/movies/movie/193/avengers_age_of_ultron\t99861\t[{\"id\": 8828, \"name\": \"marvel comic\"}, {\"id\": 9663, \"name\": \"sequel\"}, {\"id\": 9715, \"name\": \"superhero\"}, {\"id\": 9717, \"name\": \"based on comic book\"}, {\"id\": 10629, \"name\": \"vision\"}, {\"id\": 155030, \"name\": \"superhero team\"}, {\"id\": 179431, \"name\": \"duringcreditsstinger\"}, {\"id\": 180547, \"name\": \"marvel cinematic universe\"}, {\"id\": 209714, \"name\": \"3d\"}]\ten\tAvengers: Age of Ultron\tWhen Tony Stark tries to jumpstart a dormant peacekeeping program, things go awry and Earth’s Mightiest Heroes are put to the ultimate test as the fate of the planet hangs in the balance. As the villainous Ultron emerges, it is up to The Avengers to stop him from enacting his terrible plans, and soon uneasy alliances and unexpected action pave the way for an epic and unique global adventure.\t134.27924\t[{\"name\": \"Marvel Studios\", \"id\": 420}, {\"name\": \"Prime Focus\", \"id\": 15357}, {\"name\": \"Revolution Sun Studios\", \"id\": 76043}]\t[{\"iso_3166_1\": \"US\", \"name\": \"United States of America\"}]\t2015-04-22\t1405403694\t141\t[{\"iso_639_1\": \"en\", \"name\": \"English\"}]\tReleased\tA New Age Has Come.\tAvengers: Age of Ultron\t7.3\t6767\n250000000\t[{\"id\": 12, \"name\": \"Adventure\"}, {\"id\": 14, \"name\": \"Fantasy\"}, {\"id\": 10751, \"name\": \"Family\"}]\thttp://harrypotter.warnerbros.com/harrypotterandthehalf-bloodprince/dvd/index.html\t767\t[{\"id\": 616, \"name\": \"witch\"}, {\"id\": 2343, \"name\": \"magic\"}, {\"id\": 3872, \"name\": \"broom\"}, {\"id\": 3884, \"name\": \"school of witchcraft\"}, {\"id\": 6333, \"name\": \"wizardry\"}, {\"id\": 10164, \"name\": \"apparition\"}, {\"id\": 10791, \"name\": \"teenage crush\"}, {\"id\": 12564, \"name\": \"werewolf\"}]\ten\tHarry Potter and the Half-Blood Prince\tAs Harry begins his sixth year at Hogwarts, he discovers an old book marked as 'Property of the Half-Blood Prince', and begins to learn more about Lord Voldemort's dark past.\t98.885635\t[{\"name\": \"Warner Bros.\", \"id\": 6194}, {\"name\": \"Heyday Films\", \"id\": 7364}]\t[{\"iso_3166_1\": \"GB\", \"name\": \"United Kingdom\"}, {\"iso_3166_1\": \"US\", \"name\": \"United States of America\"}]\t2009-07-07\t933959197\t153\t[{\"iso_639_1\": \"en\", \"name\": \"English\"}]\tReleased\tDark Secrets Revealed\tHarry Potter and the Half-Blood Prince\t7.4\t5293\n250000000\t[{\"id\": 28, \"name\": \"Action\"}, {\"id\": 12, \"name\": \"Adventure\"}, {\"id\": 14, \"name\": \"Fantasy\"}]\thttp://www.batmanvsupermandawnofjustice.com/\t209112\t[{\"id\": 849, \"name\": \"dc comics\"}, {\"id\": 7002, \"name\": \"vigilante\"}, {\"id\": 9715, \"name\": \"superhero\"}, {\"id\": 9717, \"name\": \"based on comic book\"}, {\"id\": 9748, \"name\": \"revenge\"}, {\"id\": 163455, \"name\": \"super powers\"}, {\"id\": 195242, \"name\": \"clark kent\"}, {\"id\": 195243, \"name\": \"bruce wayne\"}, {\"id\": 229266, \"name\": \"dc extended universe\"}]\ten\tBatman v Superman: Dawn of Justice\tFearing the actions of a god-like Super Hero left unchecked, Gotham City’s own formidable, forceful vigilante takes on Metropolis’s most revered, modern-day savior, while the world wrestles with what sort of hero it really needs. And with Batman and Superman at war with one another, a new threat quickly arises, putting mankind in greater danger than it’s ever known before.\t155.79045\t[{\"name\": \"DC Comics\", \"id\": 429}, {\"name\": \"Atlas Entertainment\", \"id\": 507}, {\"name\": \"Warner Bros.\", \"id\": 6194}, {\"name\": \"DC Entertainment\", \"id\": 9993}, {\"name\": \"Cruel & Unusual Films\", \"id\": 9995}, {\"name\": \"RatPac-Dune Entertainment\", \"id\": 41624}]\t[{\"iso_3166_1\": \"US\", \"name\": \"United States of America\"}]\t2016-03-23\t873260194\t151\t[{\"iso_639_1\": \"en\", \"name\": \"English\"}]\tReleased\tJustice or revenge\tBatman v Superman: Dawn of Justice\t5.7\t7004\n270000000\t[{\"id\": 12, \"name\": \"Adventure\"}, {\"id\": 14, \"name\": \"Fantasy\"}, {\"id\": 28, \"name\": \"Action\"}, {\"id\": 878, \"name\": \"Science Fiction\"}]\thttp://www.superman.com\t1452\t[{\"id\": 83, \"name\": \"saving the world\"}, {\"id\": 849, \"name\": \"dc comics\"}, {\"id\": 8872, \"name\": \"invulnerability\"}, {\"id\": 9663, \"name\": \"sequel\"}, {\"id\": 9715, \"name\": \"superhero\"}, {\"id\": 9717, \"name\": \"based on comic book\"}, {\"id\": 163420, \"name\": \"kryptonite\"}, {\"id\": 163455, \"name\": \"super powers\"}, {\"id\": 179102, \"name\": \"superhuman strength\"}, {\"id\": 202526, \"name\": \"lex luthor\"}]\ten\tSuperman Returns\tSuperman returns to discover his 5-year absence has allowed Lex Luthor to walk free, and that those he was closest too felt abandoned and have moved on. Luthor plots his ultimate revenge that could see millions killed and change the face of the planet forever, as well as ridding himself of the Man of Steel.\t57.925625\t[{\"name\": \"DC Comics\", \"id\": 429}, {\"name\": \"Legendary Pictures\", \"id\": 923}, {\"name\": \"Warner Bros.\", \"id\": 6194}, {\"name\": \"Bad Hat Harry Productions\", \"id\": 9168}]\t[{\"iso_3166_1\": \"US\", \"name\": \"United States of America\"}]\t2006-06-28\t391081192\t154\t[{\"iso_639_1\": \"en\", \"name\": \"English\"}, {\"iso_639_1\": \"fr\", \"name\": \"Fran\\u00e7ais\"}, {\"iso_639_1\": \"de\", \"name\": \"Deutsch\"}]\tReleased\tnull\tSuperman Returns\t5.4\t1400\n200000000\t[{\"id\": 12, \"name\": \"Adventure\"}, {\"id\": 28, \"name\": \"Action\"}, {\"id\": 53, \"name\": \"Thriller\"}, {\"id\": 80, \"name\": \"Crime\"}]\thttp://www.mgm.com/view/movie/234/Quantum-of-Solace/\t10764\t[{\"id\": 627, \"name\": \"killing\"}, {\"id\": 1568, \"name\": \"undercover\"}, {\"id\": 4289, \"name\": \"secret agent\"}, {\"id\": 156095, \"name\": \"british secret service\"}]\ten\tQuantum of Solace\tQuantum of Solace continues the adventures of James Bond after Casino Royale. Betrayed by Vesper, the woman he loved, 007 fights the urge to make his latest mission personal. Pursuing his determination to uncover the truth, Bond and M interrogate Mr. White, who reveals that the organization that blackmailed Vesper is far more complex and dangerous than anyone had imagined.\t107.92881\t[{\"name\": \"Eon Productions\", \"id\": 7576}]\t[{\"iso_3166_1\": \"GB\", \"name\": \"United Kingdom\"}, {\"iso_3166_1\": \"US\", \"name\": \"United States of America\"}]\t2008-10-30\t586090727\t106\t[{\"iso_639_1\": \"en\", \"name\": \"English\"}, {\"iso_639_1\": \"es\", \"name\": \"Espa\\u00f1ol\"}, {\"iso_639_1\": \"it\", \"name\": \"Italiano\"}, {\"iso_639_1\": \"fr\", \"name\": \"Fran\\u00e7ais\"}, {\"iso_639_1\": \"de\", \"name\": \"Deutsch\"}]\tReleased\tFor love, for hate, for justice, for revenge.\tQuantum of Solace\t6.1\t2965\n200000000\t[{\"id\": 12, \"name\": \"Adventure\"}, {\"id\": 14, \"name\": \"Fantasy\"}, {\"id\": 28, \"name\": \"Action\"}]\thttp://disney.go.com/disneypictures/pirates/\t58\t[{\"id\": 616, \"name\": \"witch\"}, {\"id\": 663, \"name\": \"fortune teller\"}, {\"id\": 910, \"name\": \"bondage\"}, {\"id\": 911, \"name\": \"exotic island\"}, {\"id\": 1299, \"name\": \"monster\"}, {\"id\": 1316, \"name\": \"captain\"}, {\"id\": 1317, \"name\": \"card game\"}, {\"id\": 1319, \"name\": \"east india trading company\"}, {\"id\": 1461, \"name\": \"compass\"}, {\"id\": 3799, \"name\": \"ship\"}, {\"id\": 5600, \"name\": \"daughter\"}, {\"id\": 12988, \"name\": \"pirate\"}, {\"id\": 157186, \"name\": \"swashbuckler\"}, {\"id\": 179430, \"name\": \"aftercreditsstinger\"}]\ten\tPirates of the Caribbean: Dead Man's Chest\tCaptain Jack Sparrow works his way out of a blood debt with the ghostly Davey Jones, he also attempts to avoid eternal damnation.\t145.84738\t[{\"name\": \"Walt Disney Pictures\", \"id\": 2}, {\"name\": \"Jerry Bruckheimer Films\", \"id\": 130}, {\"name\": \"Second Mate Productions\", \"id\": 19936}]\t[{\"iso_3166_1\": \"JM\", \"name\": \"Jamaica\"}, {\"iso_3166_1\": \"US\", \"name\": \"United States of America\"}, {\"iso_3166_1\": \"BS\", \"name\": \"Bahamas\"}, {\"iso_3166_1\": \"DM\", \"name\": \"Dominica\"}]\t2006-06-20\t1065659812\t151\t[{\"iso_639_1\": \"en\", \"name\": \"English\"}, {\"iso_639_1\": \"tr\", \"name\": \"T\\u00fcrk\\u00e7e\"}, {\"iso_639_1\": \"el\", \"name\": \"\\u03b5\\u03bb\\u03bb\\u03b7\\u03bd\\u03b9\\u03ba\\u03ac\"}, {\"iso_639_1\": \"zh\", \"name\": \"\\u666e\\u901a\\u8bdd\"}]\tReleased\tJack is back!\tPirates of the Caribbean: Dead Man's Chest\t7.0\t5246\n255000000\t[{\"id\": 28, \"name\": \"Action\"}, {\"id\": 12, \"name\": \"Adventure\"}, {\"id\": 37, \"name\": \"Western\"}]\thttp://disney.go.com/the-lone-ranger/\t57201\t[{\"id\": 1556, \"name\": \"texas\"}, {\"id\": 2673, \"name\": \"horse\"}, {\"id\": 5385, \"name\": \"survivor\"}, {\"id\": 5901, \"name\": \"texas ranger\"}, {\"id\": 9104, \"name\": \"partner\"}, {\"id\": 9503, \"name\": \"outlaw\"}, {\"id\": 10685, \"name\": \"escape\"}, {\"id\": 10909, \"name\": \"lawyer\"}, {\"id\": 13008, \"name\": \"train\"}, {\"id\": 178867, \"name\": \"lone ranger\"}, {\"id\": 179419, \"name\": \"comanche\"}, {\"id\": 222787, \"name\": \"the lone ranger\"}, {\"id\": 228232, \"name\": \"tonto\"}]\ten\tThe Lone Ranger\tThe Texas Rangers chase down a gang of outlaws led by Butch Cavendish, but the gang ambushes the Rangers, seemingly killing them all. One survivor is found, however, by an American Indian named Tonto, who nurses him back to health. The Ranger, donning a mask and riding a white stallion named Silver, teams up with Tonto to bring the unscrupulous gang and others of that ilk to justice.\t49.046955\t[{\"name\": \"Walt Disney Pictures\", \"id\": 2}, {\"name\": \"Jerry Bruckheimer Films\", \"id\": 130}, {\"name\": \"Infinitum Nihil\", \"id\": 2691}, {\"name\": \"Silver Bullet Productions (II)\", \"id\": 37380}, {\"name\": \"Blind Wink Productions\", \"id\": 37381}, {\"name\": \"Classic Media\", \"id\": 37382}]\t[{\"iso_3166_1\": \"US\", \"name\": \"United States of America\"}]\t2013-07-03\t89289910\t149\t[{\"iso_639_1\": \"en\", \"name\": \"English\"}]\tReleased\tNever Take Off the Mask\tThe Lone Ranger\t5.9\t2311\n225000000\t[{\"id\": 28, \"name\": \"Action\"}, {\"id\": 12, \"name\": \"Adventure\"}, {\"id\": 14, \"name\": \"Fantasy\"}, {\"id\": 878, \"name\": \"Science Fiction\"}]\thttp://www.manofsteel.com/\t49521\t[{\"id\": 83, \"name\": \"saving the world\"}, {\"id\": 849, \"name\": \"dc comics\"}, {\"id\": 9715, \"name\": \"superhero\"}, {\"id\": 9717, \"name\": \"based on comic book\"}, {\"id\": 10761, \"name\": \"superhuman\"}, {\"id\": 14909, \"name\": \"alien invasion\"}, {\"id\": 161184, \"name\": \"reboot\"}, {\"id\": 163455, \"name\": \"super powers\"}, {\"id\": 229266, \"name\": \"dc extended universe\"}]\ten\tMan of Steel\tA young boy learns that he has extraordinary powers and is not of this earth. As a young man, he journeys to discover where he came from and what he was sent here to do. But the hero in him must emerge if he is to save the world from annihilation and become the symbol of hope for all mankind.\t99.39801\t[{\"name\": \"Legendary Pictures\", \"id\": 923}, {\"name\": \"Warner Bros.\", \"id\": 6194}, {\"name\": \"DC Entertainment\", \"id\": 9993}, {\"name\": \"Syncopy\", \"id\": 9996}, {\"name\": \"Cruel and Unusual Films\", \"id\": 78685}]\t[{\"iso_3166_1\": \"GB\", \"name\": \"United Kingdom\"}, {\"iso_3166_1\": \"US\", \"name\": \"United States of America\"}]\t2013-06-12\t662845518\t143\t[{\"iso_639_1\": \"en\", \"name\": \"English\"}]\tReleased\tYou will believe that a man can fly.\tMan of Steel\t6.5\t6359\n225000000\t[{\"id\": 12, \"name\": \"Adventure\"}, {\"id\": 10751, \"name\": \"Family\"}, {\"id\": 14, \"name\": \"Fantasy\"}]\tnull\t2454\t[{\"id\": 818, \"name\": \"based on novel\"}, {\"id\": 855, \"name\": \"fictional place\"}, {\"id\": 1155, \"name\": \"brother sister relationship\"}, {\"id\": 2043, \"name\": \"lion\"}, {\"id\": 3714, \"name\": \"human being\"}, {\"id\": 4391, \"name\": \"wretch\"}, {\"id\": 4820, \"name\": \"leap in time\"}, {\"id\": 5144, \"name\": \"matter of life and death\"}, {\"id\": 6150, \"name\": \"faith\"}, {\"id\": 6464, \"name\": \"uncle\"}, {\"id\": 166930, \"name\": \"narnia\"}, {\"id\": 170362, \"name\": \"fantasy world\"}]\ten\tThe Chronicles of Narnia: Prince Caspian\tOne year after their incredible adventures in the Lion, the Witch and the Wardrobe, Peter, Edmund, Lucy and Susan Pevensie return to Narnia to aid a young prince whose life has been threatened by the evil King Miraz. Now, with the help of a colorful cast of new characters, including Trufflehunter the badger and Nikabrik the dwarf, the Pevensie clan embarks on an incredible quest to ensure that Narnia is returned to its rightful heir.\t53.978603\t[{\"name\": \"Walt Disney\", \"id\": 5888}, {\"name\": \"Walden Media\", \"id\": 10221}, {\"name\": \"Stillking Films\", \"id\": 11345}, {\"name\": \"Ozumi Films\", \"id\": 11440}, {\"name\": \"Propeler\", \"id\": 11441}, {\"name\": \"Silverbell Films\", \"id\": 11442}, {\"name\": \"Revolution Sun Studios\", \"id\": 76043}]\t[{\"iso_3166_1\": \"CZ\", \"name\": \"Czech Republic\"}, {\"iso_3166_1\": \"PL\", \"name\": \"Poland\"}, {\"iso_3166_1\": \"SI\", \"name\": \"Slovenia\"}, {\"iso_3166_1\": \"US\", \"name\": \"United States of America\"}]\t2008-05-15\t419651413\t150\t[{\"iso_639_1\": \"en\", \"name\": \"English\"}]\tReleased\tHope has a new face.\tThe Chronicles of Narnia: Prince Caspian\t6.3\t1630\n220000000\t[{\"id\": 878, \"name\": \"Science Fiction\"}, {\"id\": 28, \"name\": \"Action\"}, {\"id\": 12, \"name\": \"Adventure\"}]\thttp://marvel.com/avengers_movie/\t24428\t[{\"id\": 242, \"name\": \"new york\"}, {\"id\": 5539, \"name\": \"shield\"}, {\"id\": 8828, \"name\": \"marvel comic\"}, {\"id\": 9715, \"name\": \"superhero\"}, {\"id\": 9717, \"name\": \"based on comic book\"}, {\"id\": 14909, \"name\": \"alien invasion\"}, {\"id\": 155030, \"name\": \"superhero team\"}, {\"id\": 179430, \"name\": \"aftercreditsstinger\"}, {\"id\": 179431, \"name\": \"duringcreditsstinger\"}, {\"id\": 180547, \"name\": \"marvel cinematic universe\"}]\ten\tThe Avengers\tWhen an unexpected enemy emerges and threatens global safety and security, Nick Fury, director of the international peacekeeping agency known as S.H.I.E.L.D., finds himself in need of a team to pull the world back from the brink of disaster. Spanning the globe, a daring recruitment effort begins!\t144.44864\t[{\"name\": \"Paramount Pictures\", \"id\": 4}, {\"name\": \"Marvel Studios\", \"id\": 420}]\t[{\"iso_3166_1\": \"US\", \"name\": \"United States of America\"}]\t2012-04-25\t1519557910\t143\t[{\"iso_639_1\": \"en\", \"name\": \"English\"}]\tReleased\tSome assembly required.\tThe Avengers\t7.4\t11776\n380000000\t[{\"id\": 12, \"name\": \"Adventure\"}, {\"id\": 28, \"name\": \"Action\"}, {\"id\": 14, \"name\": \"Fantasy\"}]\thttp://disney.go.com/pirates/index-on-stranger-tides.html#/video/\t1865\t[{\"id\": 658, \"name\": \"sea\"}, {\"id\": 1316, \"name\": \"captain\"}, {\"id\": 1860, \"name\": \"mutiny\"}, {\"id\": 1938, \"name\": \"sword\"}, {\"id\": 2569, \"name\": \"prime minister\"}, {\"id\": 3180, \"name\": \"sailing\"}, {\"id\": 3625, \"name\": \"silver\"}, {\"id\": 3799, \"name\": \"ship\"}, {\"id\": 4235, \"name\": \"duke\"}, {\"id\": 5938, \"name\": \"mermaid\"}, {\"id\": 12988, \"name\": \"pirate\"}, {\"id\": 13065, \"name\": \"soldier\"}, {\"id\": 14643, \"name\": \"battle\"}, {\"id\": 157186, \"name\": \"swashbuckler\"}, {\"id\": 179430, \"name\": \"aftercreditsstinger\"}, {\"id\": 209714, \"name\": \"3d\"}]\ten\tPirates of the Caribbean: On Stranger Tides\tCaptain Jack Sparrow crosses paths with a woman from his past, and he's not sure if it's love -- or if she's a ruthless con artist who's using him to find the fabled Fountain of Youth. When she forces him aboard the Queen Anne's Revenge, the ship of the formidable pirate Blackbeard, Jack finds himself on an unexpected adventure in which he doesn't know who to fear more: Blackbeard or the woman from his past.\t135.41385\t[{\"name\": \"Walt Disney Pictures\", \"id\": 2}, {\"name\": \"Jerry Bruckheimer Films\", \"id\": 130}, {\"name\": \"Moving Picture Company (MPC)\", \"id\": 20478}]\t[{\"iso_3166_1\": \"US\", \"name\": \"United States of America\"}]\t2011-05-14\t1045713802\t136\t[{\"iso_639_1\": \"en\", \"name\": \"English\"}, {\"iso_639_1\": \"es\", \"name\": \"Espa\\u00f1ol\"}]\tReleased\tLive Forever Or Die Trying.\tPirates of the Caribbean: On Stranger Tides\t6.4\t4948\n225000000\t[{\"id\": 28, \"name\": \"Action\"}, {\"id\": 35, \"name\": \"Comedy\"}, {\"id\": 878, \"name\": \"Science Fiction\"}]\thttp://www.sonypictures.com/movies/meninblack3/\t41154\t[{\"id\": 4379, \"name\": \"time travel\"}, {\"id\": 5455, \"name\": \"time machine\"}, {\"id\": 9951, \"name\": \"alien\"}, {\"id\": 174915, \"name\": \"fictional government agency\"}, {\"id\": 185668, \"name\": \"seeing the future\"}, {\"id\": 208756, \"name\": \"changing history\"}]\ten\tMen in Black 3\tAgents J (Will Smith) and K (Tommy Lee Jones) are back...in time. J has seen some inexplicable things in his 15 years with the Men in Black, but nothing, not even aliens, perplexes him as much as his wry, reticent partner. But when K's life and the fate of the planet are put at stake, Agent J will have to travel back in time to put things right. J discovers that there are secrets to the universe that K never told him - secrets that will reveal themselves as he teams up with the young Agent K (Josh Brolin) to save his partner, the agency, and the future of humankind.\t52.03518\t[{\"name\": \"Amblin Entertainment\", \"id\": 56}, {\"name\": \"Media Magik Entertainment\", \"id\": 5627}, {\"name\": \"Imagenation Abu Dhabi FZ\", \"id\": 6736}, {\"name\": \"Hemisphere Media Capital\", \"id\": 9169}, {\"name\": \"Parkes/MacDonald Productions\", \"id\": 11084}]\t[{\"iso_3166_1\": \"US\", \"name\": \"United States of America\"}]\t2012-05-23\t624026776\t106\t[{\"iso_639_1\": \"en\", \"name\": \"English\"}]\tReleased\tThey are back... in time.\tMen in Black 3\t6.2\t4160\n250000000\t[{\"id\": 28, \"name\": \"Action\"}, {\"id\": 12, \"name\": \"Adventure\"}, {\"id\": 14, \"name\": \"Fantasy\"}]\thttp://www.thehobbit.com/\t122917\t[{\"id\": 417, \"name\": \"corruption\"}, {\"id\": 603, \"name\": \"elves\"}, {\"id\": 604, \"name\": \"dwarves\"}, {\"id\": 606, \"name\": \"orcs\"}, {\"id\": 609, \"name\": \"middle-earth (tolkien)\"}, {\"id\": 611, \"name\": \"hobbit\"}, {\"id\": 12554, \"name\": \"dragon\"}, {\"id\": 14643, \"name\": \"battle\"}, {\"id\": 167982, \"name\": \"unlikely friendship\"}, {\"id\": 188270, \"name\": \"epic battle\"}, {\"id\": 234213, \"name\": \"sword and sorcery\"}]\ten\tThe Hobbit: The Battle of the Five Armies\tImmediately after the events of The Desolation of Smaug, Bilbo and the dwarves try to defend Erebor's mountain of treasure from others who claim it: the men of the ruined Laketown and the elves of Mirkwood. Meanwhile an army of Orcs led by Azog the Defiler is marching on Erebor, fueled by the rise of the dark lord Sauron. Dwarves, elves and men must unite, and the hope for Middle-Earth falls into Bilbo's hands.\t120.965744\t[{\"name\": \"WingNut Films\", \"id\": 11}, {\"name\": \"New Line Cinema\", \"id\": 12}, {\"name\": \"Warner Bros. Pictures\", \"id\": 174}, {\"name\": \"3Foot7\", \"id\": 7413}, {\"name\": \"Metro-Goldwyn-Mayer (MGM)\", \"id\": 8411}]\t[{\"iso_3166_1\": \"NZ\", \"name\": \"New Zealand\"}, {\"iso_3166_1\": \"US\", \"name\": \"United States of America\"}]\t2014-12-10\t956019788\t144\t[{\"iso_639_1\": \"en\", \"name\": \"English\"}]\tReleased\tWitness the defining chapter of the Middle-Earth saga\tThe Hobbit: The Battle of the Five Armies\t7.1\t4760\n"}]},"apps":[],"jobName":"paragraph_1506986368993_-2113635951","id":"20171002-231928_238341422","dateCreated":"2017-10-02T23:19:28+0000","dateStarted":"2017-10-02T23:20:05+0000","dateFinished":"2017-10-02T23:20:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:126"},{"title":"Display Rawdata (Specified Columns)","text":"%sql\n\nselect budget, id, original_language, popularity, release_date, revenue, runtime, status, title, vote_average, vote_count from rawdata limit 20\n","user":"anonymous","dateUpdated":"2017-10-03T00:12:22+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","editorHide":true,"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"budget\tid\toriginal_language\tpopularity\trelease_date\trevenue\truntime\tstatus\ttitle\tvote_average\tvote_count\n237000000\t19995\ten\t150.43758\t2009-12-10\t2787965087\t162\tReleased\tAvatar\t7.2\t11800\n300000000\t285\ten\t139.08261\t2007-05-19\t961000000\t169\tReleased\tPirates of the Caribbean: At World's End\t6.9\t4500\n245000000\t206647\ten\t107.376785\t2015-10-26\t880674609\t148\tReleased\tSpectre\t6.3\t4466\n250000000\t49026\ten\t112.31295\t2012-07-16\t1084939099\t165\tReleased\tThe Dark Knight Rises\t7.6\t9106\n260000000\t49529\ten\t43.926994\t2012-03-07\t284139100\t132\tReleased\tJohn Carter\t6.1\t2124\n258000000\t559\ten\t115.699814\t2007-05-01\t890871626\t139\tReleased\tSpider-Man 3\t5.9\t3576\n260000000\t38757\ten\t48.68197\t2010-11-24\t591794936\t100\tReleased\tTangled\t7.4\t3330\n280000000\t99861\ten\t134.27924\t2015-04-22\t1405403694\t141\tReleased\tAvengers: Age of Ultron\t7.3\t6767\n250000000\t767\ten\t98.885635\t2009-07-07\t933959197\t153\tReleased\tHarry Potter and the Half-Blood Prince\t7.4\t5293\n250000000\t209112\ten\t155.79045\t2016-03-23\t873260194\t151\tReleased\tBatman v Superman: Dawn of Justice\t5.7\t7004\n270000000\t1452\ten\t57.925625\t2006-06-28\t391081192\t154\tReleased\tSuperman Returns\t5.4\t1400\n200000000\t10764\ten\t107.92881\t2008-10-30\t586090727\t106\tReleased\tQuantum of Solace\t6.1\t2965\n200000000\t58\ten\t145.84738\t2006-06-20\t1065659812\t151\tReleased\tPirates of the Caribbean: Dead Man's Chest\t7.0\t5246\n255000000\t57201\ten\t49.046955\t2013-07-03\t89289910\t149\tReleased\tThe Lone Ranger\t5.9\t2311\n225000000\t49521\ten\t99.39801\t2013-06-12\t662845518\t143\tReleased\tMan of Steel\t6.5\t6359\n225000000\t2454\ten\t53.978603\t2008-05-15\t419651413\t150\tReleased\tThe Chronicles of Narnia: Prince Caspian\t6.3\t1630\n220000000\t24428\ten\t144.44864\t2012-04-25\t1519557910\t143\tReleased\tThe Avengers\t7.4\t11776\n380000000\t1865\ten\t135.41385\t2011-05-14\t1045713802\t136\tReleased\tPirates of the Caribbean: On Stranger Tides\t6.4\t4948\n225000000\t41154\ten\t52.03518\t2012-05-23\t624026776\t106\tReleased\tMen in Black 3\t6.2\t4160\n250000000\t122917\ten\t120.965744\t2014-12-10\t956019788\t144\tReleased\tThe Hobbit: The Battle of the Five Armies\t7.1\t4760\n"}]},"apps":[],"jobName":"paragraph_1506989446255_-2002450097","id":"20171003-001046_1186615245","dateCreated":"2017-10-03T00:10:46+0000","dateStarted":"2017-10-03T00:12:00+0000","dateFinished":"2017-10-03T00:12:01+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:127"},{"title":"Frequency - Original Language","text":"%sql\n\nselect * from (\nselect original_language, count(*) as freq from rawdata group by original_language order by freq desc) as a\nlimit 10","user":"anonymous","dateUpdated":"2017-10-02T23:30:34+0000","config":{"colWidth":4,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","title":true,"editorHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"original_language\tfreq\nen\t4431\nfr\t69\nes\t32\nde\t26\nzh\t25\nhi\t19\nja\t16\nit\t14\ncn\t12\nko\t11\n"}]},"apps":[],"jobName":"paragraph_1506986514856_-180090483","id":"20171002-232154_399447310","dateCreated":"2017-10-02T23:21:54+0000","dateStarted":"2017-10-02T23:26:08+0000","dateFinished":"2017-10-02T23:26:10+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:128"},{"title":"Frequency - Status","text":"%sql\n\nselect * from (\nselect status, count(*) as freq from rawdata group by status order by freq desc) as a\nlimit 10","user":"anonymous","dateUpdated":"2017-10-02T23:31:43+0000","config":{"colWidth":4,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":296,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","editorHide":true,"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"status\tfreq\nReleased\t4714\nRumored\t5\nPost Production\t3\n"}]},"apps":[],"jobName":"paragraph_1506987012739_871916990","id":"20171002-233012_1103538654","dateCreated":"2017-10-02T23:30:12+0000","dateStarted":"2017-10-02T23:30:55+0000","dateFinished":"2017-10-02T23:30:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:129"},{"title":"Correlation (Revenue vs Vote Count)","text":"%sql\n\nselect * from (\nselect revenue,vote_count from rawdata) as a\nlimit 200","user":"anonymous","dateUpdated":"2017-10-03T00:12:57+0000","config":{"colWidth":4,"enabled":true,"results":{"0":{"graph":{"mode":"scatterChart","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","title":true,"editorHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"revenue\tvote_count\n2787965087\t11800\n961000000\t4500\n880674609\t4466\n1084939099\t9106\n284139100\t2124\n890871626\t3576\n591794936\t3330\n1405403694\t6767\n933959197\t5293\n873260194\t7004\n391081192\t1400\n586090727\t2965\n1065659812\t5246\n89289910\t2311\n662845518\t6359\n419651413\t1630\n1519557910\t11776\n1045713802\t4948\n624026776\t4160\n956019788\t4760\n752215857\t6586\n310669540\t1398\n958400000\t4524\n372234864\t1303\n550000000\t2337\n1845034188\t7562\n1153304495\t7241\n303025485\t2114\n1513528810\t8662\n1108561013\t7604\n783766341\t4321\n1215439994\t8806\n1025491110\t4645\n459359555\t3525\n743559607\t3528\n836297228\t3138\n1091405097\t3095\n491868548\t3530\n705717432\t4179\n400062763\t2841\n559852396\t2033\n219851172\t2487\n1066969703\t4597\n371353001\t2463\n1506249360\t4176\n531865000\t5560\n747862775\t6032\n467365246\t4418\n197687603\t2598\n351040419\t3769\n335154643\t2317\n407602906\t4794\n1123746996\t3299\n786636033\t2495\n331926147\t1736\n538983207\t4641\n343471816\t2568\n521311860\t6296\n258022233\t783\n769653595\t4903\n325233863\t1095\n183987723\t2768\n356743061\t2430\n748806957\t2629\n543934787\t4721\n1004558444\t12002\n735099082\t6870\n381509870\t1423\n585174222\t8776\n185770160\t2141\n222104681\t1020\n401128639\t1387\n745000000\t7458\n173000000\t1151\n370541256\t4858\n264218220\t992\n302469017\t1962\n857611174\t6560\n966550600\t2892\n623933331\t6849\n396600000\t3118\n758539785\t4496\n710644566\t4410\n0\t34\n150962475\t1326\n714766572\t5764\n752600867\t1959\n209154322\t2846\n652105443\t6135\n471222889\t4570\n305875730\t1474\n389681935\t2491\n494878759\t4227\n435000000\t2143\n773328629\t9742\n675120017\t10867\n825532764\t13752\n77000000\t143\n1021103568\t8297\n207283925\t3428\n333932083\t3292\n353624124\t5181\n653428261\t3984\n215283742\t1470\n181674817\t583\n299370084\t1725\n798958165\t2278\n433677183\t2268\n440603537\t3631\n415686217\t1514\n449220945\t1791\n709709780\t4040\n167298192\t927\n938212738\t5494\n895921036\t5608\n624029371\t2961\n585349010\t4853\n474968763\t3624\n623722818\t4369\n374218673\t7359\n603900354\t1810\n413106170\t1971\n373062864\t4021\n424988211\t3096\n1274219009\t5295\n738599701\t3443\n644571402\t4755\n378858340\t9427\n356613439\t2129\n449326618\t6525\n309979994\t1750\n292817841\t510\n301000000\t1431\n245527149\t2320\n682330139\t3224\n0\t549\n287594577\t1171\n665692281\t1880\n318502923\t1151\n397850012\t2028\n205366737\t1891\n38992758\t199\n64459316\t874\n128388320\t954\n272912430\t843\n497409852\t2759\n746921274\t1808\n431971116\t1092\n229147509\t2142\n553799566\t2482\n441818803\t3114\n195735876\t841\n521170825\t1603\n694713380\t3972\n306941670\t1922\n202026112\t627\n456758981\t1895\n268031828\t1921\n385680446\t4518\n821708551\t5265\n609123048\t3106\n150680864\t1277\n76932943\t331\n185258983\t2811\n285444603\t767\n245360480\t1533\n371876278\t3025\n119269486\t434\n85131830\t433\n370569774\t7047\n361832400\t862\n212011111\t790\n829000000\t2553\n150406466\t373\n163712074\t3021\n183345589\t1000\n532950503\t6396\n282570682\t1074\n245724603\t2051\n373552094\t1346\n442824138\t2888\n631744560\t3145\n519311965\t5880\n847423452\t6495\n368871007\t1519\n591739379\t2322\n273339556\t1564\n554987477\t451\n293329073\t2093\n362637473\t2350\n371940071\t2061\n789804554\t5877\n49554002\t694\n243843127\t2532\n354248063\t542\n349424282\t1851\n321887208\t1918\n976475550\t7006\n61648500\t1260\n655011224\t6985\n"}]},"apps":[],"jobName":"paragraph_1506987020143_-269032064","id":"20171002-233020_123657324","dateCreated":"2017-10-02T23:30:20+0000","dateStarted":"2017-10-02T23:37:47+0000","dateFinished":"2017-10-02T23:37:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:130"},{"title":"Descriptive Stats","text":"%pyspark\n\n############################################################################################################\n#\n#   Descriptive Stats\n#       - Total Records\n#       - Variables and types\n#       - Category levels and numeric stats (min, max, avg, etc.)\n#       - Display Categories\n#       - Correlations\n#\n############################################################################################################\n\n#rawdata.show(10, True)\nprint '\\nTotal Records: ' + str(rawdata.count()) + '\\n'\nfor i in rawdata.dtypes: print i\n\nnumeric_columns = [c[0] for c in rawdata.dtypes if c[1] not in ['string']]\n\nrawdata.describe(numeric_columns + ['release_date']).show()\n\nrawdata.filter('revenue == 0').count()\n\nrawdata.groupBy('original_language').count().sort('count', ascending=False).show(15,False)\nrawdata.groupBy('status').count().sort('count', ascending=False).show(15,False)\nrawdata.groupBy('homepage').count().sort('count', ascending=False).show(15,False)\nrawdata.groupBy('release_date').count().sort('count', ascending=False).show(15,False)\n\nseen = []\nfor c1 in numeric_columns:\n    for c2 in numeric_columns:\n        correlation = rawdata.stat.corr(c1, c2)\n        if (correlation >= 0.60 or correlation <= 0.10) and (c1 != c2) and ((c1,c2) not in seen):\n            seen.append((c2,c1))\n            print str(correlation) + '\\tcorrelation for ' + str(c1) + ' and ' + str(c2)\n\n","user":"anonymous","dateUpdated":"2017-10-02T23:37:06+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python","title":true,"editorHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nTotal Records: 4722\n\n('budget', 'int')\n('genres', 'string')\n('homepage', 'string')\n('id', 'string')\n('keywords', 'string')\n('original_language', 'string')\n('original_title', 'string')\n('overview', 'string')\n('popularity', 'float')\n('production_companies', 'string')\n('production_countries', 'string')\n('release_date', 'string')\n('revenue', 'bigint')\n('runtime', 'int')\n('spoken_languages', 'string')\n('status', 'string')\n('tagline', 'string')\n('title', 'string')\n('vote_average', 'float')\n('vote_count', 'int')\n+-------+--------------------+------------------+--------------------+-----------------+------------------+-----------------+------------+\n|summary|              budget|        popularity|             revenue|          runtime|      vote_average|       vote_count|release_date|\n+-------+--------------------+------------------+--------------------+-----------------+------------------+-----------------+------------+\n|  count|                4722|              4722|                4722|             4720|              4722|             4722|        4721|\n|   mean|2.9433402482210927E7|21.686641557328763| 8.308524085811096E7|106.9646186440678| 6.094578571639693|698.1336298178738|        null|\n| stddev| 4.095160513268207E7|32.011265180284255|1.6373947497309437E8|22.71949093495764|1.1992585120633423|1242.090753906649|        null|\n|    min|                   0|               0.0|                   0|                0|               0.0|                0|  1916-09-04|\n|    max|           380000000|          875.5813|          2787965087|              338|              10.0|            13752|  2017-02-03|\n+-------+--------------------+------------------+--------------------+-----------------+------------------+-----------------+------------+\n\n+-----------------+-----+\n|original_language|count|\n+-----------------+-----+\n|en               |4431 |\n|fr               |69   |\n|es               |32   |\n|de               |26   |\n|zh               |25   |\n|hi               |19   |\n|ja               |16   |\n|it               |14   |\n|cn               |12   |\n|ko               |11   |\n|ru               |10   |\n|pt               |9    |\n|da               |6    |\n|sv               |5    |\n|fa               |4    |\n+-----------------+-----+\nonly showing top 15 rows\n\n+---------------+-----+\n|status         |count|\n+---------------+-----+\n|Released       |4714 |\n|Rumored        |5    |\n|Post Production|3    |\n+---------------+-----+\n\n+--------------------------------------------+-----+\n|homepage                                    |count|\n+--------------------------------------------+-----+\n|null                                        |3036 |\n|http://www.thehungergames.movie/            |4    |\n|http://www.missionimpossible.com/           |4    |\n|http://www.thehobbit.com/                   |3    |\n|http://www.transformersmovie.com/           |3    |\n|http://www.kungfupanda.com/                 |3    |\n|http://www.indianajones.com                 |2    |\n|http://www.munkyourself.com/                |2    |\n|http://www.howtotrainyourdragon.com/        |2    |\n|http://www.ironmanmovie.com/                |2    |\n|http://www.lordoftherings.net/              |2    |\n|http://disney.go.com/disneypictures/pirates/|2    |\n|http://www.workandtheglory.com/             |2    |\n|http://www.riomovies.com/                   |2    |\n|http://www.theamazingspiderman.com          |2    |\n+--------------------------------------------+-----+\nonly showing top 15 rows\n\n+------------+-----+\n|release_date|count|\n+------------+-----+\n|2006-01-01  |10   |\n|1999-10-22  |7    |\n|2014-12-25  |7    |\n|2004-09-03  |7    |\n|2002-01-01  |7    |\n|2005-09-16  |6    |\n|2003-01-01  |6    |\n|2007-01-01  |6    |\n|2013-07-18  |6    |\n|2011-09-30  |6    |\n|2015-10-16  |6    |\n|2006-09-01  |5    |\n|2009-09-11  |5    |\n|2001-09-07  |5    |\n|2002-12-13  |5    |\n+------------+-----+\nonly showing top 15 rows\n\n0.731812973255\tcorrelation for budget and revenue\n0.0921265516353\tcorrelation for budget and vote_average\n0.644025015987\tcorrelation for popularity and revenue\n0.777284700363\tcorrelation for popularity and vote_count\n0.781485564787\tcorrelation for revenue and vote_count\n"}]},"apps":[],"jobName":"paragraph_1506882640749_1032015126","id":"20171001-183040_1823851373","dateCreated":"2017-10-01T18:30:40+0000","dateStarted":"2017-10-02T23:35:49+0000","dateFinished":"2017-10-02T23:36:01+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:131"},{"title":"Model Transformations","text":"%pyspark\n\njson_columns = ['genres','keywords','production_companies','production_countries','spoken_languages']\ntext_columns = ['original_title','overview','tagline','title']\ndrop_columns = json_columns + ['original_title','tagline','popularity','release_date','status','original_language','homepage']\n\n# Filter DF - Drop where revenue = 0\nt1 = rawdata.filter('revenue != 0')\n#t1.count()\n\n# Extract Date/Time Variables\ndef extract_year(date_var):\n    try:\n        return datetime.datetime.strptime(date_var, '%Y-%m-%d').year\n    except:\n        return random.randint(2005,2016)\n\ndef extract_month(date_var):\n    try:\n        return datetime.datetime.strptime(date_var, '%Y-%m-%d').month\n    except:\n        return random.randint(1,12)\n\ndef extract_day(date_var):\n    try:\n        return datetime.datetime.strptime(date_var, '%Y-%m-%d').day\n    except:\n        return random.randint(1,28)\n\nudf_year  = udf(extract_year, IntegerType())\nudf_month = udf(extract_month, IntegerType())\nudf_day   = udf(extract_day, IntegerType())\n\nt1 = t1.withColumn(\"year\", udf_year('release_date')) \\\n       .withColumn(\"month\", udf_month('release_date')) \\\n       .withColumn(\"day\", udf_day('release_date'))\n\n#t1.describe(['year','month','day']).show()\n\ndef bucket_revenue(revenue):\n    if revenue <= 10000000:\n        return 'Less than $10M'\n    elif 10000000 < revenue <= 25000000:\n        return '$10M - $25M'\n    elif 25000000 < revenue <= 50000000:\n        return '$25M - $50M'\n    elif 50000000 < revenue <= 100000000:\n        return '$50M - $100M'\n    elif 100000000 < revenue <= 200000000:\n        return '$100M - $200M'\n    elif revenue > 200000000:\n        return 'Over $200M'\n    else:\n        return -1\n\nudf_bucket_revenue  = udf(bucket_revenue, StringType())\n\nt1 = t1.withColumn(\"revenue_bucket\", udf_bucket_revenue('revenue'))\n#t1.groupBy('revenue_bucket').count().sort('count', ascending=False).show(15,False)\n\n\nt1 = t1.withColumn('revenue_over_100M', (when(col(\"revenue\") >= 100000000, 1).otherwise(0)))\n#t1.groupBy('revenue_over_100M').count().sort('count', ascending=False).show(15,False)\n\ndef bucket_vote(vote_average):\n    if vote_average >= 7.0:\n        return 'Great'\n    elif 6.0 <= vote_average < 7.0:\n        return 'Good'\n    elif 5.0 <= vote_average < 6.0:\n        return 'Ok'\n    elif vote_average < 5.0:\n        return 'Bad'\n    else:\n        return 'No Vote'\n\nudf_bucket_vote  = udf(bucket_vote, StringType())\n\nt1 = t1.withColumn(\"vote_bucket\", udf_bucket_vote('vote_average'))\n#t1.groupBy('vote_bucket').count().sort('count', ascending=False).show(15,False)\n\n# Drop Columns\nfor c in drop_columns:\n    t1 = t1.drop(c)\n\n#len(rawdata.columns)\n#len(t1.columns)\n#t1.show()\nt1.createOrReplaceTempView('t1')","user":"anonymous","dateUpdated":"2017-10-02T23:40:28+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python","editorHide":true,"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1506970122599_35100020","id":"20171002-184842_1177830626","dateCreated":"2017-10-02T18:48:42+0000","dateStarted":"2017-10-02T23:40:13+0000","dateFinished":"2017-10-02T23:40:15+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:132"},{"title":"Display Transformed Dataset","text":"%sql\n\nselect * from t1 limit 20","user":"anonymous","dateUpdated":"2017-10-02T23:57:19+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false},"editorMode":"ace/mode/text","title":true,"editorHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"budget\tid\toverview\trevenue\truntime\ttitle\tvote_average\tvote_count\tyear\tmonth\tday\trevenue_bucket\trevenue_over_100M\tvote_bucket\n237000000\t19995\tIn the 22nd century, a paraplegic Marine is dispatched to the moon Pandora on a unique mission, but becomes torn between following orders and protecting an alien civilization.\t2787965087\t162\tAvatar\t7.2\t11800\t2009\t12\t10\tOver $200M\t1\tGreat\n300000000\t285\tCaptain Barbossa, long believed to be dead, has come back to life and is headed to the edge of the Earth with Will Turner and Elizabeth Swann. But nothing is quite as it seems.\t961000000\t169\tPirates of the Caribbean: At World's End\t6.9\t4500\t2007\t5\t19\tOver $200M\t1\tGood\n245000000\t206647\tA cryptic message from Bond’s past sends him on a trail to uncover a sinister organization. While M battles political forces to keep the secret service alive, Bond peels back the layers of deceit to reveal the terrible truth behind SPECTRE.\t880674609\t148\tSpectre\t6.3\t4466\t2015\t10\t26\tOver $200M\t1\tGood\n250000000\t49026\tFollowing the death of District Attorney Harvey Dent, Batman assumes responsibility for Dent's crimes to protect the late attorney's reputation and is subsequently hunted by the Gotham City Police Department. Eight years later, Batman encounters the mysterious Selina Kyle and the villainous Bane, a new terrorist leader who overwhelms Gotham's finest. The Dark Knight resurfaces to protect a city that has branded him an enemy.\t1084939099\t165\tThe Dark Knight Rises\t7.6\t9106\t2012\t7\t16\tOver $200M\t1\tGreat\n260000000\t49529\tJohn Carter is a war-weary, former military captain who's inexplicably transported to the mysterious and exotic planet of Barsoom (Mars) and reluctantly becomes embroiled in an epic conflict. It's a world on the brink of collapse, and Carter rediscovers his humanity when he realizes the survival of Barsoom and its people rests in his hands.\t284139100\t132\tJohn Carter\t6.1\t2124\t2012\t3\t7\tOver $200M\t1\tGood\n258000000\t559\tThe seemingly invincible Spider-Man goes up against an all-new crop of villain – including the shape-shifting Sandman. While Spider-Man’s superpowers are altered by an alien organism, his alter ego, Peter Parker, deals with nemesis Eddie Brock and also gets caught up in a love triangle.\t890871626\t139\tSpider-Man 3\t5.9\t3576\t2007\t5\t1\tOver $200M\t1\tOk\n260000000\t38757\tWhen the kingdom's most wanted-and most charming-bandit Flynn Rider hides out in a mysterious tower, he's taken hostage by Rapunzel, a beautiful and feisty tower-bound teen with 70 feet of magical, golden hair. Flynn's curious captor, who's looking for her ticket out of the tower where she's been locked away for years, strikes a deal with the handsome thief and the unlikely duo sets off on an action-packed escapade, complete with a super-cop horse, an over-protective chameleon and a gruff gang of pub thugs.\t591794936\t100\tTangled\t7.4\t3330\t2010\t11\t24\tOver $200M\t1\tGreat\n280000000\t99861\tWhen Tony Stark tries to jumpstart a dormant peacekeeping program, things go awry and Earth’s Mightiest Heroes are put to the ultimate test as the fate of the planet hangs in the balance. As the villainous Ultron emerges, it is up to The Avengers to stop him from enacting his terrible plans, and soon uneasy alliances and unexpected action pave the way for an epic and unique global adventure.\t1405403694\t141\tAvengers: Age of Ultron\t7.3\t6767\t2015\t4\t22\tOver $200M\t1\tGreat\n250000000\t767\tAs Harry begins his sixth year at Hogwarts, he discovers an old book marked as 'Property of the Half-Blood Prince', and begins to learn more about Lord Voldemort's dark past.\t933959197\t153\tHarry Potter and the Half-Blood Prince\t7.4\t5293\t2009\t7\t7\tOver $200M\t1\tGreat\n250000000\t209112\tFearing the actions of a god-like Super Hero left unchecked, Gotham City’s own formidable, forceful vigilante takes on Metropolis’s most revered, modern-day savior, while the world wrestles with what sort of hero it really needs. And with Batman and Superman at war with one another, a new threat quickly arises, putting mankind in greater danger than it’s ever known before.\t873260194\t151\tBatman v Superman: Dawn of Justice\t5.7\t7004\t2016\t3\t23\tOver $200M\t1\tOk\n270000000\t1452\tSuperman returns to discover his 5-year absence has allowed Lex Luthor to walk free, and that those he was closest too felt abandoned and have moved on. Luthor plots his ultimate revenge that could see millions killed and change the face of the planet forever, as well as ridding himself of the Man of Steel.\t391081192\t154\tSuperman Returns\t5.4\t1400\t2006\t6\t28\tOver $200M\t1\tOk\n200000000\t10764\tQuantum of Solace continues the adventures of James Bond after Casino Royale. Betrayed by Vesper, the woman he loved, 007 fights the urge to make his latest mission personal. Pursuing his determination to uncover the truth, Bond and M interrogate Mr. White, who reveals that the organization that blackmailed Vesper is far more complex and dangerous than anyone had imagined.\t586090727\t106\tQuantum of Solace\t6.1\t2965\t2008\t10\t30\tOver $200M\t1\tGood\n200000000\t58\tCaptain Jack Sparrow works his way out of a blood debt with the ghostly Davey Jones, he also attempts to avoid eternal damnation.\t1065659812\t151\tPirates of the Caribbean: Dead Man's Chest\t7.0\t5246\t2006\t6\t20\tOver $200M\t1\tGreat\n255000000\t57201\tThe Texas Rangers chase down a gang of outlaws led by Butch Cavendish, but the gang ambushes the Rangers, seemingly killing them all. One survivor is found, however, by an American Indian named Tonto, who nurses him back to health. The Ranger, donning a mask and riding a white stallion named Silver, teams up with Tonto to bring the unscrupulous gang and others of that ilk to justice.\t89289910\t149\tThe Lone Ranger\t5.9\t2311\t2013\t7\t3\t$50M - $100M\t0\tOk\n225000000\t49521\tA young boy learns that he has extraordinary powers and is not of this earth. As a young man, he journeys to discover where he came from and what he was sent here to do. But the hero in him must emerge if he is to save the world from annihilation and become the symbol of hope for all mankind.\t662845518\t143\tMan of Steel\t6.5\t6359\t2013\t6\t12\tOver $200M\t1\tGood\n225000000\t2454\tOne year after their incredible adventures in the Lion, the Witch and the Wardrobe, Peter, Edmund, Lucy and Susan Pevensie return to Narnia to aid a young prince whose life has been threatened by the evil King Miraz. Now, with the help of a colorful cast of new characters, including Trufflehunter the badger and Nikabrik the dwarf, the Pevensie clan embarks on an incredible quest to ensure that Narnia is returned to its rightful heir.\t419651413\t150\tThe Chronicles of Narnia: Prince Caspian\t6.3\t1630\t2008\t5\t15\tOver $200M\t1\tGood\n220000000\t24428\tWhen an unexpected enemy emerges and threatens global safety and security, Nick Fury, director of the international peacekeeping agency known as S.H.I.E.L.D., finds himself in need of a team to pull the world back from the brink of disaster. Spanning the globe, a daring recruitment effort begins!\t1519557910\t143\tThe Avengers\t7.4\t11776\t2012\t4\t25\tOver $200M\t1\tGreat\n380000000\t1865\tCaptain Jack Sparrow crosses paths with a woman from his past, and he's not sure if it's love -- or if she's a ruthless con artist who's using him to find the fabled Fountain of Youth. When she forces him aboard the Queen Anne's Revenge, the ship of the formidable pirate Blackbeard, Jack finds himself on an unexpected adventure in which he doesn't know who to fear more: Blackbeard or the woman from his past.\t1045713802\t136\tPirates of the Caribbean: On Stranger Tides\t6.4\t4948\t2011\t5\t14\tOver $200M\t1\tGood\n225000000\t41154\tAgents J (Will Smith) and K (Tommy Lee Jones) are back...in time. J has seen some inexplicable things in his 15 years with the Men in Black, but nothing, not even aliens, perplexes him as much as his wry, reticent partner. But when K's life and the fate of the planet are put at stake, Agent J will have to travel back in time to put things right. J discovers that there are secrets to the universe that K never told him - secrets that will reveal themselves as he teams up with the young Agent K (Josh Brolin) to save his partner, the agency, and the future of humankind.\t624026776\t106\tMen in Black 3\t6.2\t4160\t2012\t5\t23\tOver $200M\t1\tGood\n250000000\t122917\tImmediately after the events of The Desolation of Smaug, Bilbo and the dwarves try to defend Erebor's mountain of treasure from others who claim it: the men of the ruined Laketown and the elves of Mirkwood. Meanwhile an army of Orcs led by Azog the Defiler is marching on Erebor, fueled by the rise of the dark lord Sauron. Dwarves, elves and men must unite, and the hope for Middle-Earth falls into Bilbo's hands.\t956019788\t144\tThe Hobbit: The Battle of the Five Armies\t7.1\t4760\t2014\t12\t10\tOver $200M\t1\tGreat\n"}]},"apps":[],"jobName":"paragraph_1506987613519_528608245","id":"20171002-234013_1134996371","dateCreated":"2017-10-02T23:40:13+0000","dateStarted":"2017-10-02T23:57:16+0000","dateFinished":"2017-10-02T23:57:17+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:133"},{"title":"Predictive Model - Predict Revenue","text":"%pyspark\n\n############################################################################################################\n#\n#   Predictive Model - Predict Revenue\n#\n############################################################################################################\n\ntarget   = 'revenue_over_100M'\nfeatures = ['budget','runtime','vote_average','vote_count','year','month','day']\n\ndef evaluate_regression_model(model, test_df):\n    predictions = model.transform(test_df)\n    #predictions.select(\"label\", \"prediction\").show(30,False)\n    \n    evaluator = RegressionEvaluator(metricName=\"rmse\")  # rmse (default)|mse|r2|mae\n    RMSE = evaluator.evaluate(predictions)\n    print 'RMSE: ' + str(RMSE)\n    \n    evaluator = RegressionEvaluator(metricName=\"r2\")\n    R2 = evaluator.evaluate(predictions)\n    print 'R2:   ' + str(R2)\n    \n    return predictions\n\ndef evaluate_classification_model(model, test_df):\n    predictions = model.transform(test_df)\n    #predictions.select(\"prediction\", \"label\").show(30,False)\n    \n    # Select (prediction, true label) and compute test error\n    evaluator = MulticlassClassificationEvaluator(labelCol=\"label\", predictionCol=\"prediction\", metricName=\"accuracy\")   # f1|weightedPrecision|weightedRecall|accuracy\n    accuracy = evaluator.evaluate(predictions)\n    print(\"Accuracy: \" + str(accuracy))\n    \n    return accuracy, predictions.drop('features','label','rawPrediction')\n\n# Generate Feature Vector and id Label\nva = VectorAssembler(inputCols=features, outputCol=\"features\")\nmodelprep = va.transform(t1.na.fill(-1)).withColumn(\"label\", col(target))\n\ntraining, testing = modelprep.randomSplit([0.8, 0.2])\n\n# Gradient Boosting Classifier\ngbc = GBTClassifier(featuresCol=\"features\", labelCol=\"label\", predictionCol=\"prediction\", maxDepth=5, maxBins=32, maxIter=20, seed=12345)\ngbcmodel = gbc.fit(training)\n\n# RandomForest Classifier\nrfc = RandomForestClassifier(featuresCol=\"features\", labelCol=\"label\", predictionCol=\"prediction\", probabilityCol=\"probability\", numTrees=10, maxDepth=5, seed=12345)\nrfcmodel = rfc.fit(training)\n\n# Predictions\ngbc_accuracy, gbc_predictions = evaluate_classification_model(gbcmodel, testing)\nrfc_accuracy, rfc_predictions = evaluate_classification_model(rfcmodel, testing)\n\n#rfc_predictions.show(10,True)\n\nprint '[ INFO ] Accuracy for Gradient Boosting  ' + str(gbc_accuracy)\nprint '[ INFO ] Accuracy for RandomForest       ' + str(rfc_accuracy)\n","user":"anonymous","dateUpdated":"2017-10-03T00:04:40+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false},"editorMode":"ace/mode/text","title":true,"editorHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Accuracy: 0.834054834055\nAccuracy: 0.835497835498\n[ INFO ] Accuracy for Gradient Boosting  0.834054834055\n[ INFO ] Accuracy for RandomForest       0.835497835498\n"}]},"apps":[],"jobName":"paragraph_1506987643802_297035380","id":"20171002-234043_35477077","dateCreated":"2017-10-02T23:40:43+0000","dateStarted":"2017-10-03T00:04:40+0000","dateFinished":"2017-10-03T00:05:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:134"},{"title":"Derive Data-Driven Topics","text":"%pyspark\n\n############################################################################################################\n#\n#   Data-Driven Topics\n#\n############################################################################################################\n\nnumber_of_clusters = 15\n\ndef handle_encoding(text):\n    return \"\".join(i for i in text if ord(i)<128)\n\nudf_handle_encoding = udf(handle_encoding, StringType())\nclean_text = rfc_predictions.withColumn(\"overview\", udf_handle_encoding('overview')) \\\n                            .withColumn(\"title\", udf_handle_encoding('title'))\n\ndef cleanup_text(text):\n    words = text.split()\n    \n    # Default list of Stopwords\n    stopwords_core = ['a', u'about', u'above', u'after', u'again', u'against', u'all', u'am', u'an', u'and', u'any', u'are', u'arent', u'as', u'at', \n    u'be', u'because', u'been', u'before', u'being', u'below', u'between', u'both', u'but', u'by', \n    u'can', 'cant', 'come', u'could', 'couldnt', \n    u'd', u'did', u'didn', u'do', u'does', u'doesnt', u'doing', u'dont', u'down', u'during', \n    u'each', \n    u'few', 'finally', u'for', u'from', u'further', \n    u'had', u'hadnt', u'has', u'hasnt', u'have', u'havent', u'having', u'he', u'her', u'here', u'hers', u'herself', u'him', u'himself', u'his', u'how', \n    u'i', u'if', u'in', u'into', u'is', u'isnt', u'it', u'its', u'itself', \n    u'just', \n    u'll', \n    u'm', u'me', u'might', u'more', u'most', u'must', u'my', u'myself', \n    u'no', u'nor', u'not', u'now', \n    u'o', u'of', u'off', u'on', u'once', u'only', u'or', u'other', u'our', u'ours', u'ourselves', u'out', u'over', u'own', \n    u'r', u're', \n    u's', 'said', u'same', u'she', u'should', u'shouldnt', u'so', u'some', u'such', \n    u't', u'than', u'that', 'thats', u'the', u'their', u'theirs', u'them', u'themselves', u'then', u'there', u'these', u'they', u'this', u'those', u'through', u'to', u'too', \n    u'under', u'until', u'up', \n    u'very', \n    u'was', u'wasnt', u'we', u'were', u'werent', u'what', u'when', u'where', u'which', u'while', u'who', u'whom', u'why', u'will', u'with', u'wont', u'would', \n    u'y', u'you', u'your', u'yours', u'yourself', u'yourselves']\n    \n    # Custom List of Stopwords - Add your own here\n    stopwords_custom = ['']\n    stopwords = stopwords_core + stopwords_custom\n    stopwords = [word.lower() for word in stopwords]    \n    \n    words_out = [re.sub('[^a-zA-Z0-9]','',word) for word in words]                                       # Remove special characters\n    words_out = [word.lower() for word in words_out if len(word)>2 and word.lower() not in stopwords]     # Remove stopwords and words under X length\n    return words_out\n\n'''\ndef cleanup_text(text):\n    from textblob import TextBlob\n    text  = TextBlob(text)\n    words = [token[0].lower() for token in text.tags if (token[1]=='NN') or (token[1]=='VB') or (token[1]=='VBD')]\n    #words = [token[0].lower() for token in text.tags if (token[1]=='VB') or (token[1]=='VBD')]\n    #words = [token[0].lower() for token in text.tags if (token[1]=='NN') or (token[1]=='VB')]\n    return words\n'''\n\nudf_cleantext = udf(cleanup_text , ArrayType(StringType()))\nclean_text2   = clean_text.withColumn(\"words\", udf_cleantext('overview'))\n\n# Term Frequency Vectorization\ncv = CountVectorizer(inputCol=\"words\", outputCol=\"rawFeatures\", vocabSize = 1000)\ncvmodel = cv.fit(clean_text2)\nfeaturizedData = cvmodel.transform(clean_text2)\n\nvocab = cvmodel.vocabulary\nvocab_broadcast = sc.broadcast(vocab)\n\nidf = IDF(inputCol=\"rawFeatures\", outputCol=\"features\")\nidfModel = idf.fit(featurizedData)\nrescaledData = idfModel.transform(featurizedData)\n\n# LDA Clustering - Find Data-driven Topics\nlda = LDA(k=number_of_clusters, seed=123, optimizer=\"em\", featuresCol=\"features\")\n\nldamodel = lda.fit(rescaledData)\n\n#ldamodel.isDistributed()\n#ldamodel.vocabSize()\n\nldatopics = ldamodel.describeTopics()\n#ldatopics.show(number_of_clusters)\n\ndef map_termID_to_Word(termIndices):\n    words = []\n    for termID in termIndices:\n        words.append(vocab_broadcast.value[termID])\n    \n    return words\n\nudf_map_termID_to_Word = udf(map_termID_to_Word , ArrayType(StringType()))\nldatopics_mapped = ldatopics.withColumn(\"topic_desc\", udf_map_termID_to_Word(ldatopics.termIndices))\nldatopics_mapped.select(ldatopics_mapped.topic, ldatopics_mapped.topic_desc).show(number_of_clusters,False)\n\nldaResults = ldamodel.transform(rescaledData)\n\n#ldaResults.show()\n\n# Breakout LDA Topics for Modeling and Reporting\ndef breakout_array(index_number, record):\n    vectorlist = record.tolist()\n    return vectorlist[index_number]\n\nudf_breakout_array = udf(breakout_array, FloatType())\n\nfor index_number in range(number_of_clusters):\n    column_name  = \"Topic_\" + str(index_number)\n    ldaResults = ldaResults.withColumn(column_name, udf_breakout_array(lit(index_number), ldaResults.topicDistribution))          \n\ntext_enriched = ldaResults.drop('words','rawFeatures','features','topicDistribution')","user":"anonymous","dateUpdated":"2017-10-03T00:04:05+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","title":true,"editorHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----+---------------------------------------------------------------------------------------+\n|topic|topic_desc                                                                             |\n+-----+---------------------------------------------------------------------------------------+\n|0    |[cop, andy, two, child, revenge, find, thing, dead, goes, night]                       |\n|1    |[crew, planet, sam, captain, sara, plane, harry, sister, though, money]                |\n|2    |[death, bond, secret, men, lord, another, battle, agent, kill, one]                    |\n|3    |[young, along, mother, brother, returns, house, falls, journey, end, students]         |\n|4    |[john, love, team, town, sheriff, friend, struggle, three, white, village]             |\n|5    |[city, upon, wife, find, alien, movie, lead, alice, last, prison]                      |\n|6    |[parents, ship, david, named, emily, tries, life, baby, tells, charlie]                |\n|7    |[dreams, book, big, friends, man, ways, like, others, move, return]                    |\n|8    |[life, story, begins, star, always, comes, play, wants, real, eventually]              |\n|9    |[one, next, first, leads, together, theyre, night, york, executive, discover]          |\n|10   |[mission, accident, jack, vampire, change, faith, forever, killed, english, top]       |\n|11   |[finds, mafia, work, father, evil, criminals, estate, police, detective, international]|\n|12   |[friends, girl, true, home, lives, drug, mary, puts, christmas, trouble]               |\n|13   |[day, los, angeles, changes, female, future, ryan, high, begin, major]                 |\n|14   |[based, gets, veteran, dangerous, greek, commander, massive, peter, nicky, back]       |\n+-----+---------------------------------------------------------------------------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1506988896924_683872180","id":"20171003-000136_1941824235","dateCreated":"2017-10-03T00:01:36+0000","dateStarted":"2017-10-03T00:04:00+0000","dateFinished":"2017-10-03T00:04:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:135"},{"title":"Data-Driven Topics - Predictive Model","text":"%pyspark\n\n############################################################################################################\n#\n#   Data-Driven Topics - Predictive Model\n#\n############################################################################################################\n\ntarget   = 'revenue_over_100M'\nfeatures = ['budget','runtime','vote_average','vote_count','year','month','day'] + [\"Topic_\" + str(index_number) for index_number in range(number_of_clusters)]\n\n# Generate Feature Vector and id Label\nva = VectorAssembler(inputCols=features, outputCol=\"features\")\nmodelprep = va.transform(text_enriched.na.fill(-1)).withColumn(\"label\", col(target))\n\ntraining, testing = modelprep.randomSplit([0.8, 0.2])\n\n# RandomForest Classifier\nrfc = RandomForestClassifier(featuresCol=\"features\", labelCol=\"label\", predictionCol=\"prediction_w_text\", probabilityCol=\"probability_w_text\", numTrees=10, maxDepth=5, seed=12345)\nrfcmodel = rfc.fit(training)\n\n# Predictions\nrfc_accuracy_w_text, rfc_predictions_w_text = evaluate_classification_model(rfcmodel, testing)\n\n#rfc_predictions_w_text.show(10,True)\n\nprint '[ INFO ] Accuracy for RandomForest (without text):  ' + str(rfc_accuracy)\nprint '[ INFO ] Accuracy for RandomForest (with text):     ' + str(rfc_accuracy_w_text)\n","user":"anonymous","dateUpdated":"2017-10-03T00:13:13+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","title":true,"editorHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Accuracy: 0.889655172414\n[ INFO ] Accuracy for RandomForest (without text):  0.835497835498\n[ INFO ] Accuracy for RandomForest (with text):     0.889655172414\n"}]},"apps":[],"jobName":"paragraph_1506988966544_-298853131","id":"20171003-000246_1586567171","dateCreated":"2017-10-03T00:02:46+0000","dateStarted":"2017-10-03T00:09:12+0000","dateFinished":"2017-10-03T00:11:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:136"},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2017-10-03T00:06:18+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1506989178652_1338328415","id":"20171003-000618_1445939972","dateCreated":"2017-10-03T00:06:18+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:137"}],"name":"Movie Predictions","id":"2CWTD2U53","angularObjects":{"2CVKPXMEE:shared_process":[],"2CV7ENMET:shared_process":[],"2CTTVFNMK:shared_process":[],"2CWG1NFY4:shared_process":[],"2CW6GZD77:shared_process":[],"2CVM4S8DX:shared_process":[],"2CUNQN7ZB:shared_process":[],"2CXDBHDG8:shared_process":[],"2CTZDZKP1:shared_process":[],"2CWNGB1JE:shared_process":[],"2CTE1T41A:shared_process":[],"2CTUAVYK5:shared_process":[],"2CWAAM1YZ:shared_process":[],"2CTTNF9J6:shared_process":[],"2CUYTEFDM:shared_process":[],"2CVHM6AN7:shared_process":[],"2CWKA4JMJ:shared_process":[],"2CTNDA6WY:shared_process":[],"2CTM8F4VX:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}