{"paragraphs":[{"text":"%angular\n<h3>\nExternal <a href=\"https://console.aws.amazon.com/s3/buckets/dzaratsian/?region=us-east-1&tab=overview\" target=\"_blank\">S3 Object Storage</a>:\n</h3>\nData stored at <b>./dzaratsian/disney_bookings.csv</b>\n<br>\n<br>\nLaunch <a href=\"https://cbdtest.field.hortonworks.com\" target=\"_blank\">Cloudbreak</a>\n<br>\n<br>","user":"admin","dateUpdated":"2017-05-01T23:31:49+0000","config":{"colWidth":12,"enabled":false,"results":{},"editorSetting":{"language":"scala","editOnDblClick":true},"editorMode":"ace/mode/undefined","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"ANGULAR","data":"<h3>\nExternal <a href=\"https://console.aws.amazon.com/s3/buckets/dzaratsian/?region=us-east-1&tab=overview\" target=\"_blank\">S3 Object Storage</a>:\n</h3>\nData stored at <b>./dzaratsian/disney_bookings.csv</b>\n<br>\n<br>\nLaunch <a href=\"https://cbdtest.field.hortonworks.com\" target=\"_blank\">Cloudbreak</a>\n<br>\n<br>"}]},"apps":[],"jobName":"paragraph_1493675437745_-713744215","id":"20170501-215037_1517058986","dateCreated":"2017-05-01T21:50:37+0000","dateStarted":"2017-05-01T23:31:40+0000","dateFinished":"2017-05-01T23:31:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:938"},{"title":"Read S3 Data into Spark Memory","text":"%spark2.pyspark\n\nmyRDD = sc.textFile(\"s3a://dzaratsian/disney_bookings.csv\")\n\nprint \"\\r\\nTotal Records: \" + str(myRDD.count()) + \"\\r\\n\\r\\n\"\n","user":"admin","dateUpdated":"2017-05-01T23:23:03+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\r\nTotal Records: 1000001\r\n\r\n\n"}]},"apps":[],"jobName":"paragraph_1493522517564_1596303184","id":"20170430-032157_862574646","dateCreated":"2017-04-30T03:21:57+0000","dateStarted":"2017-05-01T23:23:03+0000","dateFinished":"2017-05-01T23:23:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:939"},{"title":"Convert to Spark DF and analyze data...","text":"%spark2.pyspark\n\nheader = myRDD.first()\n\ndf = myRDD.filter(lambda x: x != header).map(lambda x: x.split(',')).toDF(header.split(','))\n\ndf.show(10, False)\n","user":"admin","dateUpdated":"2017-05-01T21:50:30+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+------------+------------+---------+------+--------+-----+--------------+\n|uid     |booking_date|arrival_date|resort_id|rate  |children|state|length_of_stay|\n+--------+------------+------------+---------+------+--------+-----+--------------+\n|10000000|2017-03-24  |2017-04-22  |3        |331.1 |2       |41   |2             |\n|10000001|2017-03-13  |2017-03-20  |0        |120.11|2       |20   |2             |\n|10000002|2017-03-11  |2017-04-20  |7        |207.08|1       |47   |3             |\n|10000003|2017-03-15  |2017-04-27  |2        |317.24|3       |46   |6             |\n|10000004|2017-03-18  |2017-05-03  |9        |456.49|2       |16   |7             |\n|10000005|2017-03-29  |2017-05-01  |6        |186.55|3       |5    |9             |\n|10000006|2017-03-24  |2017-06-25  |5        |98.54 |2       |32   |5             |\n|10000007|2017-03-14  |2017-05-09  |3        |326.78|4       |15   |2             |\n|10000008|2017-03-02  |2017-03-04  |1        |192.94|0       |32   |10            |\n|10000009|2017-03-07  |2017-03-18  |8        |99.0  |0       |8    |3             |\n+--------+------------+------------+---------+------+--------+-----+--------------+\nonly showing top 10 rows\n\n"}]},"apps":[],"jobName":"paragraph_1493523310408_101872226","id":"20170430-033510_1907682024","dateCreated":"2017-04-30T03:35:10+0000","dateStarted":"2017-05-01T19:28:07+0000","dateFinished":"2017-05-01T19:28:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:940"},{"title":"Write Spark Dataframe to S3 (object storage)","text":"%spark2.pyspark\n\ndf.write \\\n    .format(\"parquet\") \\\n    .mode(\"overwrite\") \\\n    .option(\"header\", \"true\") \\\n    .option(\"codec\", \"gzip\") \\\n    .save(\"s3a://dzaratsian/from_spark\")\n","user":"admin","dateUpdated":"2017-05-01T19:29:09+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1493554056543_-619835451","id":"20170430-120736_1954806701","dateCreated":"2017-04-30T12:07:36+0000","dateStarted":"2017-05-01T19:29:09+0000","dateFinished":"2017-05-01T19:29:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:941"},{"text":"%angular\n<br>\nExternal <a href=\"https://console.aws.amazon.com/s3/buckets/dzaratsian/?region=us-east-1&tab=overview\" target=\"_blank\">S3 Object Storage</a>\n<br><br>","user":"admin","dateUpdated":"2017-05-01T23:32:09+0000","config":{"colWidth":12,"enabled":false,"results":{},"editorSetting":{"language":"scala","editOnDblClick":true},"editorMode":"ace/mode/undefined","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1493556632657_128746870","id":"20170430-125032_775713151","dateCreated":"2017-04-30T12:50:32+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:942","dateFinished":"2017-05-01T23:32:02+0000","dateStarted":"2017-05-01T23:32:02+0000","results":{"code":"SUCCESS","msg":[{"type":"ANGULAR","data":"<br>\nExternal <a href=\"https://console.aws.amazon.com/s3/buckets/dzaratsian/?region=us-east-1&tab=overview\" target=\"_blank\">S3 Object Storage</a>\n<br><br>"}]}},{"text":"%angular\n","user":"admin","dateUpdated":"2017-05-01T23:32:15+0000","config":{"colWidth":12,"enabled":false,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","editorHide":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1493681058617_1565398988","id":"20170501-232418_1804071569","dateCreated":"2017-05-01T23:24:18+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1402"}],"name":"Disney_S3","id":"2CEBJE8H1","angularObjects":{"2CG1V69JJ:shared_process":[],"2CEERB9ES:shared_process":[],"2CF6DXYB6:shared_process":[],"2CFHWUQK5:shared_process":[],"2CHQJHVH8:shared_process":[],"2C4U48MY3_spark2:shared_process":[],"2CEQ3SRFN:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}